

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>NSSCTF-web-wp - Sc0fie1d</title><meta name="Description" content="scofield&#39;s blog"><meta property="og:title" content="NSSCTF-web-wp" />
<meta property="og:description" content="å‡ é“webåŸºç¡€é¢˜ç›®wp" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://scofield1920.github.io/nssctf-web-wp/" /><meta property="og:image" content="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-17T00:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-17T15:38:11+08:00" /><meta property="og:site_name" content="Hugo DoIt Theme Documentation" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico" /><meta name="twitter:title" content="NSSCTF-web-wp"/>
<meta name="twitter:description" content="å‡ é“webåŸºç¡€é¢˜ç›®wp"/>
<meta name="application-name" content="scofield-blog">
<meta name="apple-mobile-web-app-title" content="scofield-blog">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://scofield1920.github.io/nssctf-web-wp/" /><link rel="prev" href="http://scofield1920.github.io/php/" /><link rel="next" href="http://scofield1920.github.io/nssctf-reverse-wp/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><meta name="google-site-verification" content="MQ8DNu27ayX6B_4ObiEDK09vGr1fdy7kOAnbd09hJk4" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "NSSCTF-web-wp",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/scofield1920.github.io\/nssctf-web-wp\/"
        },"image": ["http:\/\/scofield1920.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "web","wordcount":  888 ,
        "url": "http:\/\/scofield1920.github.io\/nssctf-web-wp\/","datePublished": "2023-11-17T00:00:00+08:00","dateModified": "2023-12-17T15:38:11+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/scofield1920.github.io\/images\/avatar.webp",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Sc0fie1d"
            },"description": ""
    }
    </script><script src="//instant.page/5.2.0" defer type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Sc0fie1d"><span class="header-title-pre"><i class='far fa-edit fa-fw'></i></span><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/links/"> Links </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/scofield1920" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-select" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="Switch Theme">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="black">Black</option>
                        <option value="auto">Auto</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Sc0fie1d"><span class="header-title-pre"><i class='far fa-edit fa-fw'></i></span><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/links/" title="">Links</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/scofield1920" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-select" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="Switch Theme">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="black">Black</option>
                    <option value="auto">Auto</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›easyupload20">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›easyupload30">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0</a></li>
        <li><a href="#nisactf-2022babyupload">[NISACTF 2022]babyupload</a></li>
        <li><a href="#nisactf-2022bingdundun">[NISACTF 2022]bingdundun~</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›jicao">[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao</a></li>
        <li><a href="#image-20230228182602104httpsscofield-1313710994cosap-beijingmyqcloudcomimage-20230228182602104pngswpuctf-2021-æ–°ç”Ÿèµ›easy_md5"><img src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png" alt="image-20230228182602104">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easy_md5</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›do_you_know_http">[SWPUCTF 2021 æ–°ç”Ÿèµ›]Do_you_know_http</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›babyrce">[SWPUCTF 2021 æ–°ç”Ÿèµ›]babyrce</a></li>
        <li><a href="#ç¬¬äº”ç©ºé—´-2021webftp">[ç¬¬äº”ç©ºé—´ 2021]WebFTP</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›include">[SWPUCTF 2021 æ–°ç”Ÿèµ›]include</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›easyrce">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyrce</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›ez_unserialize">[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_unserialize</a>
          <ul>
            <li>
              <ul>
                <li><a href="#ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–æ¼æ´">ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–æ¼æ´</a></li>
                <li><a href="#phpé­”æœ¯æ–¹æ³•">PHPé­”æœ¯æ–¹æ³•</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">NSSCTF-web-wp</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class="author fas fa-user-circle fa-fw"></span><a href="/" title="Author" rel=" author" class="author">Sc0fie1d</a>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">category <a href="/categories/web/"><i class="far fa-folder fa-fw"></i>Web</a></span></div>
            <div class="post-meta-line">
				
				<div  class="meta-item">&nbspÂ·&nbsp
				  <span id="busuanzi_container_page_pv">æœ¬æ–‡é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡</span>
				</div><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2023-11-17">2023-11-17</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2023-12-17">2023-12-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;888 words&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›easyupload20">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›easyupload30">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0</a></li>
        <li><a href="#nisactf-2022babyupload">[NISACTF 2022]babyupload</a></li>
        <li><a href="#nisactf-2022bingdundun">[NISACTF 2022]bingdundun~</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›jicao">[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao</a></li>
        <li><a href="#image-20230228182602104httpsscofield-1313710994cosap-beijingmyqcloudcomimage-20230228182602104pngswpuctf-2021-æ–°ç”Ÿèµ›easy_md5"><img src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png" alt="image-20230228182602104">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easy_md5</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›do_you_know_http">[SWPUCTF 2021 æ–°ç”Ÿèµ›]Do_you_know_http</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›babyrce">[SWPUCTF 2021 æ–°ç”Ÿèµ›]babyrce</a></li>
        <li><a href="#ç¬¬äº”ç©ºé—´-2021webftp">[ç¬¬äº”ç©ºé—´ 2021]WebFTP</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›include">[SWPUCTF 2021 æ–°ç”Ÿèµ›]include</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›easyrce">[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyrce</a></li>
        <li><a href="#swpuctf-2021-æ–°ç”Ÿèµ›ez_unserialize">[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_unserialize</a>
          <ul>
            <li>
              <ul>
                <li><a href="#ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–æ¼æ´">ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–æ¼æ´</a></li>
                <li><a href="#phpé­”æœ¯æ–¹æ³•">PHPé­”æœ¯æ–¹æ³•</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>å‡ é“webåŸºç¡€é¢˜ç›®wp</p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›easyupload20" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9beasyupload20" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0</h3><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227203926944.png" title="image-20230227203926944" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227203926944.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227203926944.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227203926944.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227203926944.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227203926944.png 2x"
            sizes="auto"
            alt="image-20230227203926944">
    </a></figure></p>
<p>å‡ ä¸ªå¸¸ç”¨çš„å§¿åŠ¿è¯•è¿‡äº†ï¼ŒPHPï¼ŒPhpè¡Œä¸é€šï¼Œæœ€åæ”¹æˆphtmlï¼ŒæˆåŠŸä¸Šä¼ </p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227204121456.png" title="image-20230227204121456" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227204121456.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227204121456.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227204121456.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227204121456.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227204121456.png 2x"
            sizes="auto"
            alt="image-20230227204121456">
    </a></figure></p>
<p>æœ€åèšå‰‘ï¼ŒæˆåŠŸè¿æ¥</p>
<p>ã€å¤ç›˜ã€‘æŸ¥çœ‹upload.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">?</span><span class="n">php</span>
</span></span><span class="line"><span class="cl"><span class="n">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">echo</span> <span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span>\<span class="s2">&#34;utf-8</span><span class="se">\&#34;</span><span class="s2">&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">isset</span><span class="p">(</span><span class="o">$</span><span class="n">_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">_SESSION</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">md5</span><span class="p">((</span><span class="n">string</span><span class="p">)</span><span class="n">time</span><span class="p">()</span> <span class="o">.</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">isset</span><span class="p">(</span><span class="o">$</span><span class="n">_FILES</span><span class="p">[</span><span class="s1">&#39;uploaded&#39;</span><span class="p">]))</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">target_path</span>  <span class="o">=</span>  <span class="s2">&#34;./upload&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">t_path</span> <span class="o">=</span> <span class="o">$</span><span class="n">target_path</span> <span class="o">.</span> <span class="s2">&#34;/&#34;</span> <span class="o">.</span> <span class="n">basename</span><span class="p">(</span><span class="o">$</span><span class="n">_FILES</span><span class="p">[</span><span class="s1">&#39;uploaded&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">uploaded_name</span> <span class="o">=</span> <span class="o">$</span><span class="n">_FILES</span><span class="p">[</span><span class="s1">&#39;uploaded&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">uploaded_ext</span>  <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="o">$</span><span class="n">uploaded_name</span><span class="p">,</span> <span class="n">strrpos</span><span class="p">(</span><span class="o">$</span><span class="n">uploaded_name</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">uploaded_size</span> <span class="o">=</span> <span class="o">$</span><span class="n">_FILES</span><span class="p">[</span><span class="s1">&#39;uploaded&#39;</span><span class="p">][</span><span class="s1">&#39;size&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">uploaded_tmp</span>  <span class="o">=</span> <span class="o">$</span><span class="n">_FILES</span><span class="p">[</span><span class="s1">&#39;uploaded&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">preg_match</span><span class="p">(</span><span class="s2">&#34;/php|hta|ini/i&#34;</span><span class="p">,</span> <span class="o">$</span><span class="n">uploaded_ext</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">die</span><span class="p">(</span><span class="s2">&#34;phpæ˜¯ä¸è¡Œæ»´&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">$</span><span class="n">content</span> <span class="o">=</span> <span class="n">file_get_contents</span><span class="p">(</span><span class="o">$</span><span class="n">uploaded_tmp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">move_uploaded_file</span><span class="p">(</span><span class="o">$</span><span class="n">uploaded_tmp</span><span class="p">,</span> <span class="o">$</span><span class="n">t_path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">echo</span> <span class="s2">&#34;{$t_path} succesfully uploaded!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">die</span><span class="p">(</span><span class="s2">&#34;ä¸ä¼ ğŸè¿˜æƒ³è¦f1ag?&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">?</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹	å‘ç°ç”¨æ­£åˆ™è¡¨è¾¾è¿‡æ»¤äº†php.hta/ini
â€‹	åŒæ—¶ï¼Œphp3ï¼Œphp5ï¼Œphtï¼Œphtmlï¼Œphpséƒ½æ˜¯phpå¯è¿è¡Œçš„æ–‡ä»¶æ‰©å±•å</p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›easyupload30" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9beasyupload30" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0</h3><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205104603.png" title="image-20230227205104603" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205104603.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205104603.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205104603.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205104603.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205104603.png 2x"
            sizes="auto"
            alt="image-20230227205104603">
    </a></figure></p>
<p>çœ‹èµ›é¢˜æ ‡ç­¾ï¼Œæç¤ºäº†.htaccessï¼Œæœæ–­png+.htaccessç»„åˆ</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205029686.png" title="image-20230227205029686" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205029686.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205029686.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205029686.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205029686.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227205029686.png 2x"
            sizes="auto"
            alt="image-20230227205029686">
    </a></figure></p>
<h3 id="nisactf-2022babyupload" class="headerLink">
    <a href="#nisactf-2022babyupload" class="header-mark"></a>[NISACTF 2022]babyupload</h3><p>F12å‘ç°æœ‰ç›®å½•ï¼Œè¿›è¡Œè®¿é—®åä¸‹è½½å¾—åˆ°uploadæºç ï¼Œè¿›è¡Œä»£ç å®¡è®¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">upload</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;.&#34;</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Bad filename!&#34;</span><span class="p">,</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span> <span class="o">=</span> <span class="n">db</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">uid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
</span></span><span class="line"><span class="cl">    <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;insert into files (id, path) values (?, ?)&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">IntegrityError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Duplicate file&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;uploads/&#39;</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/file/&#39;</span> <span class="o">+</span> <span class="n">uid</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯çŸ¥ï¼Œè‹¥ä¸Šä¼ çš„æ–‡ä»¶ä¸­åŒ…å«â€œ.â€ï¼Œåˆ™ä¼šè¿”å›Bad filename!ï¼Œé‚£æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªæ²¡æœ‰åç¼€çš„æ–‡ä»¶</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227212011588.png" title="image-20230227212011588" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227212011588.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227212011588.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227212011588.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227212011588.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227212011588.png 2x"
            sizes="auto"
            alt="image-20230227212011588">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">upload</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;.&#34;</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Bad filename!&#34;</span><span class="p">,</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span> <span class="o">=</span> <span class="n">db</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">uid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
</span></span><span class="line"><span class="cl">    <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;insert into files (id, path) values (?, ?)&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">IntegrityError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Duplicate file&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;uploads/&#39;</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/file/&#39;</span> <span class="o">+</span> <span class="n">uid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/file/&lt;id&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">file</span><span class="p">(</span><span class="n">id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span> <span class="o">=</span> <span class="n">db</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;select path from files where id=?&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">id</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">res</span> <span class="n">is</span> <span class="n">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;File not found&#34;</span><span class="p">,</span> <span class="mi">404</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># print(res[0])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">with</span> <span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&#34;uploads/&#34;</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&#34;r&#34;</span><span class="p">)</span> <span class="n">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šä¼ åç”Ÿæˆä¸€ä¸ªuuidï¼Œå¹¶å°†uuidå’Œæ–‡ä»¶åå­˜å…¥æ•°æ®åº“ä¸­ï¼Œå¹¶è¿”å›æ–‡ä»¶çš„uuidã€‚å†é€šè¿‡<code>/file/uuid</code>è®¿é—®æ–‡ä»¶ï¼Œé€šè¿‡æŸ¥è¯¢æ•°æ®åº“å¾—åˆ°å¯¹åº”æ–‡ä»¶åï¼Œåœ¨æ–‡ä»¶åå‰æ‹¼æ¥<code>uploads/</code>åè¯»å–è¯¥è·¯å¾„ä¸‹ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p>
<blockquote>
<p><strong>ç»å¯¹è·¯å¾„æ‹¼æ¥æ¼æ´</strong></p>
<p>â€‹	os.path.join(path,*paths)å‡½æ•°ç”¨äºå°†å¤šä¸ªæ–‡ä»¶è·¯å¾„è¿æ¥æˆä¸€ä¸ªç»„åˆçš„è·¯å¾„ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°é€šå¸¸åŒ…å«äº†åŸºç¡€è·¯å¾„ï¼Œè€Œä¹‹åçš„æ¯ä¸ªå‚æ•°è¢«å½“ä½œç»„ä»¶æ‹¼æ¥åˆ°åŸºç¡€è·¯å¾„ä¹‹åã€‚</p>
<p>â€‹	ç„¶è€Œï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå°‘æœ‰äººçŸ¥çš„ç‰¹æ€§ï¼Œå¦‚æœæ‹¼æ¥çš„æŸä¸ªè·¯å¾„ä»¥ / å¼€å¤´ï¼Œé‚£ä¹ˆåŒ…æ‹¬åŸºç¡€è·¯å¾„åœ¨å†…çš„æ‰€æœ‰å‰ç¼€è·¯å¾„éƒ½å°†è¢«åˆ é™¤ï¼Œè¯¥è·¯å¾„å°†è§†ä¸ºç»å¯¹è·¯å¾„</p>
</blockquote>
<p>å½“ä¸Šä¼ çš„æ–‡ä»¶åä¸º /flag ï¼Œä¸Šä¼ åé€šè¿‡uuidè®¿é—®æ–‡ä»¶åï¼ŒæŸ¥è¯¢åˆ°çš„æ–‡ä»¶åæ˜¯ /flag ï¼Œé‚£ä¹ˆè¿›è¡Œè·¯å¾„æ‹¼æ¥æ—¶ï¼Œuploads/ å°†è¢«åˆ é™¤ï¼Œè¯»å–åˆ°çš„å°±æ˜¯æ ¹ç›®å½•ä¸‹çš„ flag æ–‡ä»¶ã€‚</p>
<h3 id="nisactf-2022bingdundun" class="headerLink">
    <a href="#nisactf-2022bingdundun" class="header-mark"></a>[NISACTF 2022]bingdundun~</h3><p>é¢˜ç›®æç¤ºå¯ä»¥ä¸Šä¼ å‹ç¼©åŒ…ï¼Œå…³äºphar://ä¼ªåè®®ï¼ŒChatGPTç»™å‡ºäº†è¿™æ ·çš„</p>
<p>Phar:// æ˜¯ PHP ä¸­çš„ä¸€ä¸ªä¼ªåè®®ï¼Œç”¨äºè®¿é—® Phar ï¼ˆPHP Archiveï¼‰æ–‡ä»¶ï¼ŒPhar æ˜¯ä¸€ç§ç±»ä¼¼äº Zip çš„æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºå°†å¤šä¸ª PHP æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å¯ä»¥åƒä¸€ä¸ªæ™®é€šçš„ PHP æ–‡ä»¶ä¸€æ ·ä½¿ç”¨ã€‚</p>
<blockquote>
<p>ä¸»è¦æ˜¯ç”¨äºåœ¨phpä¸­å¯¹å‹ç¼©æ–‡ä»¶æ ¼å¼çš„è¯»å–ã€‚è¿™ç§æ–¹å¼é€šå¸¸æ˜¯ç”¨æ¥é…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ä½¿ç”¨ï¼Œæˆ–è€…è¿›è¡Œè¿›é˜¶çš„pharååºåˆ—åŒ–æ”»å‡»</p>
<p>ç”¨æ³•å°±æ˜¯æŠŠä¸€å¥è¯æœ¨é©¬å‹ç¼©æˆzipæ ¼å¼ï¼Œshell.php -&gt; shell.zipï¼Œç„¶åå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆåç»­é€šè¿‡å‰ç«¯é¡µé¢ä¸Šä¼ ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œé€šå¸¸æœåŠ¡å™¨ä¸ä¼šé™åˆ¶ä¸Šä¼  zip æ–‡ä»¶ï¼‰ï¼Œå†è®¿é—®ï¼š?filename=phar://â€¦/shell.zip/shell.php</p>
<p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/YangYubo091699/article/details/127351065</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œä¸Šä¼ a.zip(a.phpä¸€å¥è¯æœ¨é©¬)ï¼Œ</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223242867.png" title="image-20230227223242867" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223242867.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223242867.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223242867.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223242867.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223242867.png 2x"
            sizes="auto"
            alt="image-20230227223242867">
    </a></figure></p>
<p>æ ¹æ®é¦–é¡µç»™çš„æç¤ºï¼Œæ„é€ payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://1.14.71.254:28403/?bingdundun=phar://6d3604f6ad66f035685c8e4caa342aea.zip/a
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223354412.png" title="image-20230227223354412" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223354412.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223354412.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223354412.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223354412.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230227223354412.png 2x"
            sizes="auto"
            alt="image-20230227223354412">
    </a></figure></p>
<p>éšååœ¨èšå‰‘è¿æ¥ï¼Œå¹¶åœ¨æ ¹ç›®å½•å‘ç°äº†flag</p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›jicao" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9bjicao" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao</h3><p>phpä»£ç å®¡è®¡</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228162903097.png" title="image-20230228162903097" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228162903097.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228162903097.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228162903097.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228162903097.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228162903097.png 2x"
            sizes="auto"
            alt="image-20230228162903097">
    </a></figure></p>
<p>â€‹	åˆ†æä»£ç å¯çŸ¥ï¼Œéœ€è¦ç”¨getæ–¹æ³•ä¼ è¿›ä¸€ä¸ªjsonï¼Œä»¥åŠé€šè¿‡postæ–¹æ³•ä¼ å…¥ä¸€ä¸ªid
â€‹	æ„é€ æ•°æ®åŒ…å¦‚ä¸‹ï¼š</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228163043675.png" title="image-20230228163043675" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228163043675.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228163043675.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228163043675.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228163043675.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228163043675.png 2x"
            sizes="auto"
            alt="image-20230228163043675">
    </a></figure></p>
<p>â€‹	å›æ˜¾å¾—åˆ°flag</p>
<h3 id="image-20230228182602104httpsscofield-1313710994cosap-beijingmyqcloudcomimage-20230228182602104pngswpuctf-2021-æ–°ç”Ÿèµ›easy_md5" class="headerLink">
    <a href="#image-20230228182602104httpsscofield-1313710994cosap-beijingmyqcloudcomimage-20230228182602104pngswpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9beasy_md5" class="header-mark"></a><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png" title="image-20230228182602104" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png 2x"
            sizes="auto"
            alt="image-20230228182602104">
    </a></figure>[SWPUCTF 2021 æ–°ç”Ÿèµ›]easy_md5</h3><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png" title="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png 2x"
            sizes="auto"
            alt="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228182602104.png">
    </a></figure>
è¿›è¡Œä»£ç å®¡è®¡ï¼Œè¦æ±‚nameå’Œpasswordçš„å€¼ä¸åŒï¼ŒåŒæ—¶è¦æ±‚ä¸¤è€…çš„mdç›¸åŒï¼Œç„¶è€Œè¿›è¡Œåˆ¤æ–­æ˜¯ç”¨çš„æ˜¯&quot;==&ldquo;ç¬¦å·ï¼Œè¿™æ˜¯phpçš„å¼±ç±»å‹æ¯”è¾ƒ
æ³•ä¸€ï¼šå¯ä»¥ä½¿ç”¨å¸¦0eå¼€å¤´çš„æ•°å­—ä¸²è¿›è¡Œå‚æ•°ä¼ é€’ï¼Œå› ä¸ºPHPä¼šå°†0eå¼€å¤´çš„æ•°å­—è½¬åŒ–ä¸º0ï¼Œæ•…æ­¤æ—¶md5å€¼ç›¸ç­‰ï¼ŒäºŒæ¥èƒ½å¤Ÿç»™å˜é‡çš„å€¼ä¸ç›¸ç­‰ã€‚
æ³•äºŒï¼šå¯ä»¥ä¼ é€’æ•°ç»„ï¼Œå¦‚name[]=123ï¼Œpassword[]=456ï¼Œmd5ä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œæ•…ä¸¤ä¸ªmd5è¿”å›çš„éƒ½æ˜¯null</p>
<p>â€‹	ï¼ˆå¦ï¼šè‹¥é‡åˆ°<code>===</code>è¿™æ ·çš„å¼ºç±»å‹æ¯”è¾ƒï¼Œæ–¹æ³•ä¸€å°±å¤±æ•ˆäº†ï¼Œæ–¹æ³•äºŒä»ç„¶æœ‰æ•ˆï¼Œæˆ–è€…è¿˜å¯ä»¥ä½¿ç”¨è½¯ä»¶fastcollè¿›è¡Œmd5ç¢°æ’ï¼Œç”Ÿæˆä¸¤ä¸ªå­—ç¬¦ä¸²ä½¿å¾—ä»–ä»¬çš„md5å€¼ç›¸åŒï¼‰</p>
<p>â€‹	å¦ï¼š0eå¼€å¤´çš„æ•°å­—</p>
<blockquote>
<p>s878926199a
0e545993274517709034328855841020
s155964671a
0e342768416822451524974117254469
s214587387a
0e848240448830537924465865611904
s214587387a
0e848240448830537924465865611904
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s1885207154a
0e509367213418206700842008763514
s1502113478a
0e861580163291561247404381396064
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s155964671a
0e342768416822451524974117254469
s1184209335a
0e072485820392773389523109082030
s1665632922a
0e731198061491163073197128363787
s1502113478a
0e861580163291561247404381396064
s1836677006a
0e481036490867661113260034900752
s1091221200a
0e940624217856561557816327384675
s155964671a
0e342768416822451524974117254469
s1502113478a
0e861580163291561247404381396064
s155964671a
0e342768416822451524974117254469
s1665632922a
0e731198061491163073197128363787
s155964671a
0e342768416822451524974117254469
s1091221200a
0e940624217856561557816327384675
s1836677006a
0e481036490867661113260034900752
s1885207154a
0e509367213418206700842008763514
s532378020a
0e220463095855511507588041205815
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s214587387a
0e848240448830537924465865611904
s1502113478a
0e861580163291561247404381396064
s1091221200a
0e940624217856561557816327384675
s1665632922a
0e731198061491163073197128363787
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s1665632922a
0e731198061491163073197128363787
s878926199a
0e545993274517709034328855841020
240610708
0e462097431906509019562988736854
314282422</p>
</blockquote>
<p>ä½¿ç”¨bpå‘åŒ…ï¼Œå¾—åˆ°flag</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184224073.png" title="image-20230228184224073" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184224073.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184224073.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184224073.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184224073.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184224073.png 2x"
            sizes="auto"
            alt="image-20230228184224073">
    </a></figure></p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›do_you_know_http" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9bdo_you_know_http" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]Do_you_know_http</h3><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184640217.png" title="image-20230228184640217" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184640217.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184640217.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184640217.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184640217.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184640217.png 2x"
            sizes="auto"
            alt="image-20230228184640217">
    </a></figure></p>
<p>æ ¹æ®é¡µé¢åé¦ˆä¿¡æ¯ï¼Œä»¥åŠé¢˜ç›®æè¿°æç¤ºï¼Œè¿›è¡ŒæŠ“åŒ…ä¿®æ”¹user-agentå¹¶æ·»åŠ xffï¼Œåœ¨è¿”å›ä¿¡æ¯ä¸­ï¼Œå¾—åˆ°location</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184610682.png" title="image-20230228184610682" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184610682.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184610682.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184610682.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184610682.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184610682.png 2x"
            sizes="auto"
            alt="image-20230228184610682">
    </a></figure></p>
<p>è®¿é—®a.php</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184803323.png" title="image-20230228184803323" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184803323.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184803323.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184803323.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184803323.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184803323.png 2x"
            sizes="auto"
            alt="image-20230228184803323">
    </a></figure></p>
<p>å†æ¬¡å‘åŒ…ï¼Œå‘ç°æ–°ç«™ç‚¹
<figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184939746.png" title="image-20230228184939746" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184939746.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184939746.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184939746.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184939746.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228184939746.png 2x"
            sizes="auto"
            alt="image-20230228184939746">
    </a></figure></p>
<p>è®¿é—®åå¾—åˆ°flag</p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›babyrce" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9bbabyrce" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]babyrce</h3><p><figure><a class="lightgallery" href="C:%5cUsers%5cScofield_Lee%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230228185051813.png" title="image-20230228185051813" data-thumbnail="C:\Users\Scofield_Lee\AppData\Roaming\Typora\typora-user-images\image-20230228185051813.png">
        <img
            
            loading="lazy"
            src="C:%5cUsers%5cScofield_Lee%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230228185051813.png"
            srcset="C:%5cUsers%5cScofield_Lee%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230228185051813.png, C:%5cUsers%5cScofield_Lee%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230228185051813.png 1.5x, C:%5cUsers%5cScofield_Lee%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230228185051813.png 2x"
            sizes="auto"
            alt="image-20230228185051813">
    </a></figure></p>
<p>æ ¹æ®é¢˜ç›®æç¤ºæ¨æµ‹ï¼Œåº”è¯¥è·Ÿcookieæœ‰å…³
æŠ“åŒ…ä¿®æ”¹cookieçš„å€¼ï¼Œå‘åŒ…åå‘ç°æ–°ç«™ç‚¹ï¼š</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228185550733.png" title="image-20230228185550733" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228185550733.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228185550733.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228185550733.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228185550733.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228185550733.png 2x"
            sizes="auto"
            alt="image-20230228185550733">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">error_reporting(0);
</span></span><span class="line"><span class="cl">highlight_file(__FILE__);
</span></span><span class="line"><span class="cl">error_reporting(0);
</span></span><span class="line"><span class="cl">if (isset($_GET[&#39;url&#39;])) {
</span></span><span class="line"><span class="cl">  $ip=$_GET[&#39;url&#39;];
</span></span><span class="line"><span class="cl">  if(preg_match(&#34;/ /&#34;, $ip)){
</span></span><span class="line"><span class="cl">      die(&#39;nonono&#39;);
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">  $a = shell_exec($ip);
</span></span><span class="line"><span class="cl">  echo $a;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">?&gt; nonono
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹	ä»ä»£ç å±‚é¢æ¥çœ‹ï¼Œå±è”½äº†ç©ºæ ¼ï¼ˆ ï¼‰ï¼Œæ‰€ä»¥è¦é‡‡å–æ‰‹æ®µæ¥ç»•è¿‡å¯¹ç©ºæ ¼çš„å±è”½ï¼Œå¦‚æœä¼ å…¥çš„urlå€¼ä¸åŒ…å«ç©ºæ ¼ï¼Œåˆ™é€šè¿‡å‡½æ•° **$a = shell_exec($ip);**è¿›è¡Œè¿œç¨‹rce</p>
<blockquote>
<p>åœ¨è¿‡æ»¤äº†ç©ºæ ¼çš„ç³»ç»Ÿä¸­ï¼Œä»¥cat flag.txtä¸ºä¾‹ï¼Œç³»ç»Ÿä¸å…è®¸æˆ‘ä»¬è¾“å…¥ç©ºæ ¼æˆ–è¾“å…¥åè¢«è¿‡æ»¤ã€‚</p>
<p>${IFS}</p>
<p>å¯ä½¿ç”¨${IFS}ä»£æ›¿ç©ºæ ¼ã€‚</p>
<p>cat${IFS}flag.txt</p>
<p>cat$IFS$1flag.txt</p>
<p>cat${IFS}$1flag.txt</p>
</blockquote>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190745205.png" title="image-20230228190745205" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190745205.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190745205.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190745205.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190745205.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190745205.png 2x"
            sizes="auto"
            alt="image-20230228190745205">
    </a></figure></p>
<p>å…ˆæŸ¥çœ‹æ ¹ç›®å½•ï¼Œå‘ç°ç–‘ä¼¼æ–‡ä»¶
éšåä½¿ç”¨tacæˆ–catè¯»å–æ–‡ä»¶ï¼Œå¾—åˆ°flag
<figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190903485.png" title="image-20230228190903485" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190903485.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190903485.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190903485.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190903485.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228190903485.png 2x"
            sizes="auto"
            alt="image-20230228190903485">
    </a></figure></p>
<h3 id="ç¬¬äº”ç©ºé—´-2021webftp" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%94%e7%a9%ba%e9%97%b4-2021webftp" class="header-mark"></a>[ç¬¬äº”ç©ºé—´ 2021]WebFTP</h3><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228193747945.png" title="image-20230228193747945" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228193747945.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228193747945.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228193747945.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228193747945.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228193747945.png 2x"
            sizes="auto"
            alt="image-20230228193747945">
    </a></figure></p>
<p>â€‹	F12å‘ç°ç”¨æˆ·åä¸ºadminï¼Œå°è¯•çˆ†ç ´å¼±å£ä»¤ï¼Œå¯æƒœæ²¡çˆ†ç ´å‡ºæ¥ï¼Œæ‰«æç½‘ç«™åå°ï¼Œå‘ç°æœ‰.gitæ–‡ä»¶ï¼Œä½¿ç”¨githackerè¿›è¡Œæ‰’å–ï¼Œè¿™é‡Œå¤ä¹ ä¸€ä¸‹githackerçš„ç”¨æ³•ï¼ŒåŠŸèƒ½ä¸Šæ˜¯æ¯”githackè¦å¼ºå¤§çš„ã€‚
â€‹	è¿›å…¥åˆ°Githackeræ–‡ä»¶å¤¹æ‰§è¡Œ<code>__init__.py</code>æ ¼å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/githacker/GitHacker]
</span></span><span class="line"><span class="cl">â””â”€# python __init__.py --url http://1.14.71.254:28784/.git/ --output-folder result
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹	æ‰’å–åˆ°çš„ç›¸å…³æ–‡ä»¶ä¼šè¾“å‡ºåˆ°è¯¥ç›®å½•ä¸‹resultæ–‡ä»¶å¤¹ä¸­ï¼ŒæŸ¥çœ‹readme.mdæ–‡æ¡£ï¼Œå‘ç°åˆå§‹è´¦å·å’Œå¯†ç </p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194410519.png" title="image-20230228194410519" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194410519.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194410519.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194410519.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194410519.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194410519.png 2x"
            sizes="auto"
            alt="image-20230228194410519">
    </a></figure></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194643435.png" title="image-20230228194643435" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194643435.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194643435.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194643435.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194643435.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228194643435.png 2x"
            sizes="auto"
            alt="image-20230228194643435">
    </a></figure></p>
<p>â€‹	è¿›å»ä¹‹åï¼Œå¥½åƒæ²¡å•¥åµç”¨ï¼Œphpinfo.phpæ–‡ä»¶åœ¨ç›®å½•var/www/htmlä¸­ï¼Œä½†å‘ç°æ— æ³•åœ¨ftpé‡Œé¢ç›´æ¥æ‰“å¼€ã€‚
â€‹	ç›´æ¥è®¿é—®<code>http://1.14.71.254:28306/.phpinfo.php</code>å°±å¯ä»¥äº†
â€‹	æˆ‘è§‰å¾—å€’æ˜¯åšäº†è®¸å¤šæ— ç”¨åŠŸï¼Œå¤ç›˜æ—¶è¿”ç°ç›´æ¥dirsearchè¿”å›çš„ç»“æœä¸­é™¤äº†.gitï¼Œä¹ŸåŒ…å«äº†README.mdæ–‡ä»¶ä»¥åŠphpinfo.phpéƒ½å¯ä»¥ç›´æ¥è®¿é—®ï¼Œåœ¨phpinfoé¡µé¢æœç´¢flagç›´æ¥å‡ºã€‚</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228195643826.png" title="image-20230228195643826" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228195643826.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228195643826.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228195643826.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228195643826.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228195643826.png 2x"
            sizes="auto"
            alt="image-20230228195643826">
    </a></figure></p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›include" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9binclude" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]include</h3><p>â€‹	è¿›å…¥ç¯å¢ƒï¼Œæç¤ºä¼ å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ­¤å¤–å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰æ•ˆä¿¡æ¯ï¼Œdirsearchæ‰«æåå°ç›®å½•ï¼Œä¹Ÿæ²¡å•¥æœ‰æ•ˆä¿¡æ¯ï¼Œå°è¯•phpä¼ªåè®®</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201522848.png" title="image-20230228201522848" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201522848.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201522848.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201522848.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201522848.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201522848.png 2x"
            sizes="auto"
            alt="image-20230228201522848">
    </a></figure></p>
<p>â€‹	æ„é€ payloadè¿›è¡Œgetä¼ å‚ï¼š<code>http://1.14.71.254:28956/?file=flag</code></p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201804240.png" title="image-20230228201804240" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201804240.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201804240.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201804240.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201804240.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228201804240.png 2x"
            sizes="auto"
            alt="image-20230228201804240">
    </a></figure></p>
<p>å‘ç°æœ‰<strong>include_onceå‡½æ•°</strong></p>
<p>include_once()ï¼šåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚è¯¥å‡½æ•°å’Œinclude å‡½æ•°ç±»ä¼¼ï¼Œä¸¤è€…å”¯ä¸€çš„åŒºåˆ«æ˜¯ ä½¿ç”¨è¯¥å‡½æ•°çš„æ—¶å€™ï¼Œphpä¼šåŠ æ£€æŸ¥æŒ‡å®šæ–‡ä»¶æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¸ä¼šå†è¢«åŒ…å«ã€‚</p>
<p>äºæ˜¯åˆ©ç”¨ä¼ªåè®®æ„é€ ï¼Œå¾—åˆ°ç»è¿‡base64ç¼–ç çš„flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://1.14.71.254:28956/?file=php://filter/convert.base64-encode/resource=flag.php
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204810974.png" title="image-20230228204810974" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204810974.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204810974.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204810974.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204810974.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204810974.png 2x"
            sizes="auto"
            alt="image-20230228204810974">
    </a></figure>
è‡³äºä¸ºä»€ä¹ˆè¦ä½¿ç”¨base64è¿›è¡Œç¼–ç è¾“å‡º</p>
<blockquote>
<p><strong>å¸¸è§çš„phpä¼ªåè®®</strong></p>
<p>1ï¼‰file:// è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</p>
<p>2ï¼‰http:// è®¿é—®HTTP(S)ç½‘å€</p>
<p>3ï¼‰ftp:// è®¿é—®FTP(S)URL</p>
<p>4)php:// è®¿é—®å„ä¸ªè¾“å‡ºè¾“å…¥æµ</p>
<p>5)zlib:// å¤„ç†å‹ç¼©æµ</p>
<p>6)data:// è¯»å–æ•°æ®</p>
<p>7)glob:// æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</p>
<p>8)phar:// PHPå½’æ¡£</p>
<p>9)rar:// RARæ•°æ®å‹ç¼©</p>
</blockquote>
<p>è‡³äºä¸ºä»€ä¹ˆè¦ä½¿ç”¨base64ç¼–ç ï¼ŒChatGPTç»™å‡ºäº†è¿™æ ·çš„å›ç­”ï¼š</p>
<blockquote>
<p>ä¸ºäº†å°†ç›®æ ‡æ–‡ä»¶å†…å®¹ä»¥æ–‡æœ¬å½¢å¼ä¼ è¾“ç»™æ”»å‡»è€…ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šå°†ç›®æ ‡æ–‡ä»¶å†…å®¹è¿›è¡Œç¼–ç ï¼Œä¾‹å¦‚ä½¿ç”¨Base64ç¼–ç ã€‚è¿™æ˜¯å› ä¸ºHTTPåè®®åªèƒ½ä¼ è¾“æ–‡æœ¬æ•°æ®ï¼Œå¯¹äºäºŒè¿›åˆ¶æ•°æ®ï¼Œå¦‚å›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘ç­‰ï¼Œéœ€è¦è¿›è¡Œç¼–ç æ‰èƒ½åœ¨HTTPè¯·æ±‚å’Œå“åº”ä¸­ä¼ è¾“ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥å°†ç›®æ ‡æ–‡ä»¶å†…å®¹è¿›è¡ŒBase64ç¼–ç ï¼Œç„¶åå°†ç¼–ç åçš„ç»“æœä½œä¸ºHTTPè¯·æ±‚æˆ–å“åº”çš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œå®ç°ä¼ è¾“ã€‚åœ¨æ¥æ”¶åˆ°å“åº”åï¼Œæ”»å‡»è€…å¯ä»¥å°†ç¼–ç åçš„ç»“æœè§£ç ï¼Œä»è€Œè·å¾—åŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå³ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ã€‚</p>
</blockquote>
<p>(æˆ‘ä»¬è¯»å–çš„æ˜¯flag.phpï¼Œè€Œå¹¶é.txtæ–‡ä»¶)</p>
<p>å¼•ç”¨ä¸€ä¸‹<a href="https://blog.csdn.net/L2329794714" target="_blank" rel="noopener noreferrer">å¤´ç§ƒçš„bug</a>å¸ˆå‚…åœ¨CSDNçš„ç¬”è®°ï¼š</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204934173.png" title="image-20230228204934173" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204934173.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204934173.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204934173.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204934173.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228204934173.png 2x"
            sizes="auto"
            alt="image-20230228204934173">
    </a></figure></p>
<blockquote>
<p><strong>è¿‡æ»¤å™¨çš„åˆ†ç±»ï¼ˆåŠå¸¸è§è¿‡æ»¤å™¨ï¼‰ï¼š</strong></p>
<p><strong>string filter(å­—ç¬¦è¿‡æ»¤å™¨)</strong>
<strong>string.rot13  (å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 è½¬æ¢)</strong>
ä¾‹ï¼šphp://filter/string.rot13/resource=flag.php
<strong>string.toupper (è½¬å¤§å†™)</strong>
ä¾‹ï¼šphp://filter/string.toupper/resource=flag.php
<strong>string.tolower (è½¬å°å†™)</strong>
<strong>string.strip_tags (å»é™¤ HTML å’Œ PHP æ ‡è®°ï¼Œå°è¯•è¿”å›ç»™å®šçš„å­—ç¬¦ä¸² str å»é™¤ç©ºå­—ç¬¦ã€HTML å’Œ PHP æ ‡è®°åçš„ç»“æœ)</strong>
ä¾‹ï¼šphp://filter/string.strip_tags/resource=flag.php
<strong>conversion filter (è½¬æ¢è¿‡æ»¤å™¨)</strong>
convert.base64-encode &amp; convert.base64-decode (base64åŠ å¯† base64è§£å¯†)
ä¾‹ï¼šphp://filter/convert.base64-encode/resource=flag.php
convert.quoted-printable-encode &amp; convert.quoted-printable-decode(åœ¨å­—ç¬¦ä¸²ååŠ =0A,åŠæ¢å¤)
<strong>compression filter(å‹ç¼©è¿‡æ»¤)</strong>
zlib.deflate &amp; zlib.inflate(å‹ç¼© è§£å‹)
ä¾‹ï¼šphp://filter/zlib.deflate/resource=flag.php                                                       php://filter/zlib.inflate/resource=flag.php
bzip2.compress &amp; bzip2.decompress(zip å‹ç¼© è§£å‹)
<strong>encryption filter(åŠ å¯†è¿‡æ»¤å™¨)</strong></p>
</blockquote>
<p>æ‘˜è‡ªï¼šhttps://blog.csdn.net/L2329794714/article/details/121288668</p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›easyrce" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9beasyrce" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyrce</h3><p>ç°å¸¸ç®€å•çš„rceï¼Œ
<img src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205604826.png" alt="image-20230228205604826" style="zoom:67%;" /></p>
<p>åœ¨phpinfoä¸­æœªå‘ç°flagï¼Œéšåæ„é€ ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://1.14.71.254:28678/?url=system(&#34;ls /);
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205746590.png" title="image-20230228205746590" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205746590.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205746590.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205746590.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205746590.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228205746590.png 2x"
            sizes="auto"
            alt="image-20230228205746590">
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://1.14.71.254:28678/?url=system(%22tac%20/flllllaaaaaaggggggg%22);
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°flag</p>
<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›ez_unserialize" class="headerLink">
    <a href="#swpuctf-2021-%e6%96%b0%e7%94%9f%e8%b5%9bez_unserialize" class="header-mark"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_unserialize</h3><img src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210051445.png" alt="image-20230228210051445" style="zoom:67%;" />
<p>æ²¡å•¥æœ‰æ•ˆä¿¡æ¯ï¼Œæ‰«æä¸€ä¸‹åå°ï¼Œå‘ç°</p>
<p><figure><a class="lightgallery" href="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210325967.png" title="image-20230228210325967" data-thumbnail="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210325967.png">
        <img
            
            loading="lazy"
            src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210325967.png"
            srcset="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210325967.png, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210325967.png 1.5x, https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210325967.png 2x"
            sizes="auto"
            alt="image-20230228210325967">
    </a></figure></p>
<p>è¿›å…¥c145s.phpï¼Œå¾—åˆ°æºä»£ç 
<img src="https://scofield-1313710994.cos.ap-beijing.myqcloud.com/image-20230228210349597.png" alt="image-20230228210349597" style="zoom:80%;" /></p>
<p>ç»å…¸phpååºåˆ—åŒ–ï¼ŒChatGPTè®²çš„å¾ˆæ˜ç¡®äº†</p>
<blockquote>
<ol>
<li>ç¦ç”¨é”™è¯¯æŠ¥å‘Šã€‚<code>error_reporting(0);</code> å¯ä»¥ç¦ç”¨ PHP çš„é”™è¯¯æŠ¥å‘Šï¼Œä»¥ç¡®ä¿æ”»å‡»è€…æ— æ³•é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥äº†è§£ä»£ç çš„è¿è¡Œæƒ…å†µã€‚</li>
<li>æ˜¾ç¤º <code>cl45s.php</code> çš„æºä»£ç ã€‚<code>show_source(&quot;cl45s.php&quot;);</code> ç”¨äºå°† <code>cl45s.php</code> çš„æºä»£ç æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œè¿™å¯ä»¥å¸®åŠ©æ”»å‡»è€…æ›´å¥½åœ°äº†è§£ä»£ç çš„è¿è¡Œæƒ…å†µå’Œæ¼æ´ç‚¹ã€‚</li>
<li>å®šä¹‰ <code>wllm</code> ç±»ã€‚è¿™ä¸ªç±»å…·æœ‰ä¸¤ä¸ªå…¬å…±å±æ€§ <code>$admin</code> å’Œ <code>$passwd</code>ï¼Œåˆ†åˆ«ç”¨äºå­˜å‚¨ç”¨æˆ·åå’Œå¯†ç ã€‚ç±»ä¸­å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯æ„é€ å‡½æ•° <code>__construct()</code>ï¼Œç”¨äºåˆå§‹åŒ– <code>$admin</code> å’Œ <code>$passwd</code> çš„å€¼ï¼›å¦ä¸€ä¸ªæ˜¯ææ„å‡½æ•° <code>__destruct()</code>ï¼Œå½“å¯¹è±¡è¢«é”€æ¯æ—¶æ‰§è¡Œã€‚</li>
<li>å¤„ç†ä¼ å…¥çš„å‚æ•°ã€‚<code>$p = $_GET['p'];</code> ç”¨äºè·å– URL å‚æ•°ä¸­åä¸º <code>p</code> çš„å€¼ã€‚</li>
<li>ååºåˆ—åŒ–ã€‚<code>unserialize($p);</code> å°†ä¼ å…¥çš„å‚æ•° <code>$p</code> è¿›è¡Œååºåˆ—åŒ–å¤„ç†ï¼Œå³å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º PHP å¯¹è±¡ã€‚</li>
<li>è°ƒç”¨ææ„å‡½æ•°ã€‚ç”±äºåœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œå› æ­¤åœ¨å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•° <code>__destruct()</code>ã€‚åœ¨ææ„å‡½æ•°ä¸­ï¼Œå¦‚æœ <code>$admin</code> çš„å€¼ä¸º <code>&quot;admin&quot;</code>ï¼Œ<code>$passwd</code> çš„å€¼ä¸º <code>&quot;ctf&quot;</code>ï¼Œåˆ™ä¼šåŒ…å«ä¸€ä¸ªåä¸º <code>flag.php</code> çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä¸­çš„ <code>$flag</code> å˜é‡è¾“å‡ºåˆ°é¡µé¢ä¸Šã€‚å¦åˆ™ï¼Œä¼šå°† <code>$admin</code> å’Œ <code>$passwd</code> çš„å€¼è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œå¹¶è¾“å‡ºä¸€æ¡æç¤ºä¿¡æ¯ã€‚</li>
</ol>
</blockquote>
<p>ä¼ å…¥ä»¥ä¸‹å‚æ•°å¾—åˆ°flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://1.14.71.254:28814/cl45s.php?p=O:4:%22wllm%22:2:{s:5:%22admin%22;s:5:%22admin%22;s:6:%22passwd%22;s:3:%22ctf%22;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>[å¤ä¹ phpååºåˆ—åŒ–]</p>
<blockquote>
<h5 id="ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–æ¼æ´" class="headerLink">
    <a href="#%e4%bb%80%e4%b9%88%e6%98%af%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e" class="header-mark"></a>ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–æ¼æ´</h5><p>å½“ç¨‹åºåœ¨è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚__wakeup(),__destruct()ç­‰å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœä¼ å…¥å‡½æ•°çš„å‚æ•°å¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶çš„è¯ï¼Œç”¨æˆ·å¯ä»¥è¾“å…¥ä¸€äº›æ¶æ„ä»£ç åˆ°å‡½æ•°ä¸­ï¼Œä»è€Œå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ã€‚</p>
<h5 id="phpé­”æœ¯æ–¹æ³•" class="headerLink">
    <a href="#php%e9%ad%94%e6%9c%af%e6%96%b9%e6%b3%95" class="header-mark"></a>PHPé­”æœ¯æ–¹æ³•</h5><p>é­”æœ¯æ–¹æ³•æ˜¯PHPé¢å‘å¯¹è±¡ä¸­ç‰¹æœ‰çš„ç‰¹æ€§ã€‚å®ƒä»¬åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è¢«è§¦å‘ï¼Œéƒ½æ˜¯ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´ï¼Œåˆ©ç”¨é­”æœ¯æ–¹æ³•å¯ä»¥è½»æ¾å®ç°PHPé¢å‘å¯¹è±¡ä¸­é‡è½½ï¼ˆOverloadingå³åŠ¨æ€åˆ›å»ºç±»å±æ€§å’Œæ–¹æ³•ï¼‰ã€‚ é—®é¢˜å°±å‡ºç°åœ¨é‡è½½è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç›¸å…³ä»£ç ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„phpé­”æœ¯æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">1</span><span class="err">ã€</span><span class="n">__get</span><span class="err">ã€</span><span class="n">__set</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯ä¸ºåœ¨ç±»å’Œä»–ä»¬çš„çˆ¶ç±»ä¸­æ²¡æœ‰å£°æ˜çš„å±æ€§è€Œè®¾è®¡çš„</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__get</span><span class="p">(</span> <span class="o">$</span><span class="n">property</span> <span class="p">)</span> <span class="err">å½“è°ƒç”¨ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§æ—¶è®¿é—®æ­¤æ–¹æ³•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__set</span><span class="p">(</span> <span class="o">$</span><span class="n">property</span><span class="p">,</span> <span class="o">$</span><span class="n">value</span> <span class="p">)</span> <span class="err">ç»™ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§èµ‹å€¼æ—¶è°ƒç”¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">è¿™é‡Œçš„æ²¡æœ‰å£°æ˜åŒ…æ‹¬è®¿é—®æ§åˆ¶ä¸º</span><span class="n">proteced</span><span class="p">,</span><span class="n">privateçš„å±æ€§</span><span class="err">ï¼ˆå³æ²¡æœ‰æƒé™è®¿é—®çš„å±æ€§ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">2</span><span class="err">ã€</span><span class="n">__isset</span><span class="err">ã€</span><span class="n">__unset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__isset</span><span class="p">(</span> <span class="o">$</span><span class="n">property</span> <span class="p">)</span> <span class="err">å½“åœ¨ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§ä¸Šè°ƒç”¨</span><span class="n">isset</span><span class="p">()</span><span class="err">å‡½æ•°æ—¶è°ƒç”¨æ­¤æ–¹æ³•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__unset</span><span class="p">(</span> <span class="o">$</span><span class="n">property</span> <span class="p">)</span> <span class="err">å½“åœ¨ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§ä¸Šè°ƒç”¨</span><span class="n">unset</span><span class="p">()</span><span class="err">å‡½æ•°æ—¶è°ƒç”¨æ­¤æ–¹æ³•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ä¸</span><span class="n">__getæ–¹æ³•å’Œ__setæ–¹æ³•ç›¸åŒ</span><span class="err">ï¼Œè¿™é‡Œçš„æ²¡æœ‰å£°æ˜åŒ…æ‹¬è®¿é—®æ§åˆ¶ä¸º</span><span class="n">proteced</span><span class="p">,</span><span class="n">privateçš„å±æ€§</span><span class="err">ï¼ˆå³æ²¡æœ‰æƒé™è®¿é—®çš„å±æ€§ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">3</span><span class="err">ã€</span><span class="n">__call</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__call</span><span class="p">(</span> <span class="o">$</span><span class="n">method</span><span class="p">,</span> <span class="o">$</span><span class="n">arg_array</span> <span class="p">)</span> <span class="err">å½“è°ƒç”¨ä¸€ä¸ªæœªå®šä¹‰</span><span class="p">(</span><span class="err">åŒ…æ‹¬æ²¡æœ‰æƒé™è®¿é—®</span><span class="p">)</span><span class="err">çš„æ–¹æ³•æ˜¯è°ƒç”¨æ­¤æ–¹æ³•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">4</span><span class="err">ã€</span><span class="n">__autoload</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__autoload</span> <span class="err">å‡½æ•°ï¼Œä½¿ç”¨å°šæœªè¢«å®šä¹‰çš„ç±»æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚é€šè¿‡æ­¤å‡½æ•°ï¼Œè„šæœ¬å¼•æ“åœ¨</span> <span class="n">PHP</span> <span class="err">å‡ºé”™å¤±è´¥å‰æœ‰äº†æœ€åä¸€ä¸ªæœºä¼šåŠ è½½æ‰€éœ€çš„ç±»ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">æ³¨æ„</span><span class="p">:</span> <span class="err">åœ¨</span> <span class="n">__autoload</span> <span class="err">å‡½æ•°ä¸­æŠ›å‡ºçš„å¼‚å¸¸ä¸èƒ½è¢«</span> <span class="n">catch</span> <span class="err">è¯­å¥å—æ•è·å¹¶å¯¼è‡´è‡´å‘½é”™è¯¯ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">5</span><span class="err">ã€</span><span class="n">__construct</span><span class="err">ã€</span><span class="n">__destruct</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__construct</span> <span class="err">æ„é€ æ–¹æ³•ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶è°ƒç”¨æ­¤æ–¹æ³•ï¼Œå¥½å¤„æ˜¯å¯ä»¥ä½¿æ„é€ æ–¹æ³•æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„åç§°ï¼Œæ— è®ºå®ƒæ‰€åœ¨çš„ç±»çš„åç§°æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·ä½ åœ¨æ”¹å˜ç±»çš„åç§°æ—¶ï¼Œå°±ä¸éœ€è¦æ”¹å˜æ„é€ æ–¹æ³•çš„åç§°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__destruct</span> <span class="err">ææ„æ–¹æ³•ï¼Œ</span><span class="n">PHPå°†åœ¨å¯¹è±¡è¢«é”€æ¯å‰</span><span class="err">ï¼ˆå³ä»å†…å­˜ä¸­æ¸…é™¤å‰ï¼‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">é»˜è®¤æƒ…å†µä¸‹</span><span class="p">,</span><span class="n">PHPä»…ä»…é‡Šæ”¾å¯¹è±¡å±æ€§æ‰€å ç”¨çš„å†…å­˜å¹¶é”€æ¯å¯¹è±¡ç›¸å…³çš„èµ„æº</span><span class="o">.</span><span class="err">ï¼Œææ„å‡½æ•°å…è®¸ä½ åœ¨ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä¹‹åæ‰§è¡Œä»»æ„ä»£ç æ¥æ¸…é™¤å†…å­˜ï¼Œå½“</span><span class="n">PHPå†³å®šä½ çš„è„šæœ¬ä¸å†ä¸å¯¹è±¡ç›¸å…³æ—¶</span><span class="err">ï¼Œææ„å‡½æ•°å°†è¢«è°ƒç”¨</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">åœ¨ä¸€ä¸ªå‡½æ•°çš„å‘½åç©ºé—´å†…ï¼Œè¿™ä¼šå‘ç”Ÿåœ¨å‡½æ•°</span><span class="n">returnçš„æ—¶å€™</span><span class="err">ï¼Œå¯¹äºå…¨å±€å˜é‡ï¼Œè¿™å‘ç”Ÿäºè„šæœ¬ç»“æŸçš„æ—¶å€™ï¼Œå¦‚æœä½ æƒ³æ˜ç¡®åœ°é”€æ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å¯ä»¥ç»™æŒ‡å‘è¯¥å¯¹è±¡çš„å˜é‡åˆ†é…ä»»ä½•å…¶å®ƒå€¼ï¼Œé€šå¸¸å°†å˜é‡èµ‹å€¼å‹¤ä¸º</span><span class="n">NULLæˆ–è€…è°ƒç”¨unset</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">6</span><span class="err">ã€</span><span class="n">__clone</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PHP5ä¸­çš„å¯¹è±¡èµ‹å€¼æ˜¯ä½¿ç”¨çš„å¼•ç”¨èµ‹å€¼</span><span class="err">ï¼Œä½¿ç”¨</span><span class="n">cloneæ–¹æ³•å¤åˆ¶ä¸€ä¸ªå¯¹è±¡æ—¶</span><span class="err">ï¼Œå¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨</span><span class="n">__cloneé­”æœ¯æ–¹æ³•</span><span class="err">ï¼Œå¦‚æœåœ¨å¯¹è±¡å¤åˆ¶éœ€è¦æ‰§è¡ŒæŸäº›åˆå§‹åŒ–æ“ä½œï¼Œå¯ä»¥åœ¨</span><span class="n">__cloneæ–¹æ³•å®ç°</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">7</span><span class="err">ã€</span><span class="n">__toString</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__toStringæ–¹æ³•åœ¨å°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨</span><span class="err">ï¼Œæ¯”å¦‚ä½¿ç”¨</span><span class="n">echoæ‰“å°å¯¹è±¡æ—¶</span><span class="err">ï¼Œå¦‚æœç±»æ²¡æœ‰å®ç°æ­¤æ–¹æ³•ï¼Œåˆ™æ— æ³•é€šè¿‡</span><span class="n">echoæ‰“å°å¯¹è±¡</span><span class="err">ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºï¼š</span><span class="n">Catchable</span> <span class="n">fatal</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Object</span> <span class="n">of</span> <span class="k">class</span> <span class="n">test</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">string</span> <span class="ow">in</span><span class="err">ï¼Œæ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">åœ¨</span><span class="n">PHP</span> <span class="mf">5.2</span><span class="o">.</span><span class="mi">0</span><span class="err">ä¹‹å‰ï¼Œ</span><span class="n">__toStringæ–¹æ³•åªæœ‰ç»“åˆä½¿ç”¨echo</span><span class="p">()</span> <span class="err">æˆ–</span> <span class="nb">print</span><span class="p">()</span><span class="err">æ—¶</span> <span class="err">æ‰èƒ½ç”Ÿæ•ˆã€‚</span><span class="n">PHP</span> <span class="mf">5.2</span><span class="o">.</span><span class="mi">0</span><span class="err">ä¹‹åï¼Œåˆ™å¯ä»¥åœ¨ä»»ä½•å­—ç¬¦ä¸²ç¯å¢ƒç”Ÿæ•ˆï¼ˆä¾‹å¦‚é€šè¿‡</span><span class="n">printf</span><span class="p">()</span><span class="err">ï¼Œä½¿ç”¨</span><span class="o">%</span><span class="n">sä¿®é¥°ç¬¦</span><span class="err">ï¼‰ï¼Œä½†</span> <span class="err">ä¸èƒ½ç”¨äºéå­—ç¬¦ä¸²ç¯å¢ƒï¼ˆå¦‚ä½¿ç”¨</span><span class="o">%</span><span class="n">dä¿®é¥°ç¬¦</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ä»</span><span class="n">PHP</span> <span class="mf">5.2</span><span class="o">.</span><span class="mi">0</span><span class="err">ï¼Œå¦‚æœå°†ä¸€ä¸ªæœªå®šä¹‰</span><span class="n">__toStringæ–¹æ³•çš„å¯¹è±¡</span> <span class="err">è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¼šæŠ¥å‡ºä¸€ä¸ª</span><span class="n">E_RECOVERABLE_ERRORé”™è¯¯</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">8</span><span class="err">ã€</span><span class="n">__sleep</span><span class="err">ã€</span><span class="n">__wakeup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__sleep</span> <span class="err">ä¸²è¡ŒåŒ–çš„æ—¶å€™ç”¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__wakeup</span> <span class="err">åä¸²è¡ŒåŒ–çš„æ—¶å€™è°ƒç”¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">serialize</span><span class="p">()</span> <span class="err">æ£€æŸ¥ç±»ä¸­æ˜¯å¦æœ‰é­”æœ¯åç§°</span> <span class="n">__sleep</span> <span class="err">çš„å‡½æ•°ã€‚å¦‚æœè¿™æ ·ï¼Œè¯¥å‡½æ•°å°†åœ¨ä»»ä½•åºåˆ—åŒ–ä¹‹å‰è¿è¡Œã€‚å®ƒå¯ä»¥æ¸…é™¤å¯¹è±¡å¹¶åº”è¯¥è¿”å›ä¸€ä¸ªåŒ…å«æœ‰è¯¥å¯¹è±¡ä¸­åº”è¢«åºåˆ—åŒ–çš„æ‰€æœ‰å˜é‡åçš„æ•°ç»„ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ä½¿ç”¨</span> <span class="n">__sleep</span> <span class="err">çš„ç›®çš„æ˜¯å…³é—­å¯¹è±¡å¯èƒ½å…·æœ‰çš„ä»»ä½•æ•°æ®åº“è¿æ¥ï¼Œæäº¤ç­‰å¾…ä¸­çš„æ•°æ®æˆ–è¿›è¡Œç±»ä¼¼çš„æ¸…é™¤ä»»åŠ¡ã€‚æ­¤å¤–ï¼Œå¦‚æœæœ‰éå¸¸å¤§çš„å¯¹è±¡è€Œå¹¶ä¸éœ€è¦å®Œå…¨å‚¨å­˜ä¸‹æ¥æ—¶æ­¤å‡½æ•°ä¹Ÿå¾ˆæœ‰ç”¨ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ç›¸ååœ°ï¼Œ</span><span class="n">unserialize</span><span class="p">()</span> <span class="err">æ£€æŸ¥å…·æœ‰é­”æœ¯åç§°</span> <span class="n">__wakeup</span> <span class="err">çš„å‡½æ•°çš„å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨ï¼Œæ­¤å‡½æ•°å¯ä»¥é‡å»ºå¯¹è±¡å¯èƒ½å…·æœ‰çš„ä»»ä½•èµ„æºã€‚ä½¿ç”¨</span> <span class="n">__wakeup</span> <span class="err">çš„ç›®çš„æ˜¯é‡å»ºåœ¨åºåˆ—åŒ–ä¸­å¯èƒ½ä¸¢å¤±çš„ä»»ä½•æ•°æ®åº“è¿æ¥ä»¥åŠå¤„ç†å…¶å®ƒé‡æ–°åˆå§‹åŒ–çš„ä»»åŠ¡ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">9</span><span class="err">ã€</span><span class="n">__set_state</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">å½“è°ƒç”¨</span><span class="n">var_export</span><span class="p">()</span><span class="err">æ—¶ï¼Œè¿™ä¸ªé™æ€</span> <span class="err">æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼ˆè‡ª</span><span class="n">PHP</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">0</span><span class="err">èµ·æœ‰æ•ˆï¼‰ã€‚æœ¬æ–¹æ³•çš„å”¯ä¸€å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æŒ‰</span><span class="n">array</span><span class="p">(</span><span class="err">â€™</span><span class="n">property</span><span class="err">â€™</span> <span class="o">=&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="err">â€¦</span><span class="p">)</span><span class="err">æ ¼å¼æ’åˆ—çš„ç±»å±æ€§ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">10</span><span class="err">ã€</span><span class="n">__invoke</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ</span><span class="n">__invoke</span> <span class="err">æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</span><span class="n">PHP5</span><span class="o">.</span><span class="mf">3.0</span><span class="err">ä»¥ä¸Šç‰ˆæœ¬æœ‰æ•ˆ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">11</span><span class="err">ã€</span><span class="n">__callStatic</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">å®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äº</span> <span class="n">__call</span><span class="p">()</span> <span class="err">é­”æœ¯æ–¹æ³•ï¼Œ</span><span class="n">__callStatic</span><span class="p">()</span> <span class="err">æ˜¯ä¸ºäº†å¤„ç†é™æ€æ–¹æ³•è°ƒç”¨ï¼Œ</span><span class="n">PHP5</span><span class="o">.</span><span class="mf">3.0</span><span class="err">ä»¥ä¸Šç‰ˆæœ¬æœ‰æ•ˆï¼Œ</span><span class="n">PHP</span> <span class="err">ç¡®å®åŠ å¼ºäº†å¯¹</span> <span class="n">__callStatic</span><span class="p">()</span> <span class="err">æ–¹æ³•çš„å®šä¹‰ï¼›å®ƒå¿…é¡»æ˜¯å…¬å…±çš„ï¼Œå¹¶ä¸”å¿…é¡»è¢«å£°æ˜ä¸ºé™æ€çš„ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">åŒæ ·ï¼Œ</span><span class="n">__call</span><span class="p">()</span> <span class="err">é­”æœ¯æ–¹æ³•å¿…é¡»è¢«å®šä¹‰ä¸ºå…¬å…±çš„ï¼Œæ‰€æœ‰å…¶ä»–é­”æœ¯æ–¹æ³•éƒ½å¿…é¡»å¦‚æ­¤ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-12-17&nbsp;<a class="git-hash" href="https://github.com/HEIGE-PCloud/DoIt/commit/969375dd70cd7acbf2e549364429ffcb642588c5" target="_blank" title="commit by scofield(scofield_1920@outlook.com) 969375dd70cd7acbf2e549364429ffcb642588c5: data" rel="noopener noreferrer">
                                    <i class="fas fa-hashtag fa-fw"></i>969375d</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/nssctf-web-wp/index.md target="_blank" rel="noopener noreferrer">Read markdown</a>
                    </span><span>|&nbsp;<a class="link-to-source" href=https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts\NSSCTF-web-wp.md target="_blank" rel="noopener noreferrer">View source</a>
                    </span><span>|&nbsp;<a class="link-to-edit" href=https://github.com/HEIGE-PCloud/DoIt/edit/main/exampleSite/content/posts\NSSCTF-web-wp.md target="_blank" rel="noopener noreferrer">Edit this page</a>
                    </span><span>|&nbsp;<a class="link-to-report" href=https://github.com/HEIGE-PCloud/DoIt/issues/new?title=[bug]%20NSSCTF-web-wp&body=|Field|Value|%0A|-|-|%0A|Title|NSSCTF-web-wp|%0A|Url|http://scofield1920.github.io/nssctf-web-wp/|%0A|Filename|https://github.com/HEIGE-PCloud/DoIt/blob/main/exampleSite/content/posts\NSSCTF-web-wp.md| target="_blank" rel="noopener noreferrer">Report issue</a>
                    </span></div>
            <div class="post-info-share"><button title="Share on Twitter" data-sharer="twitter" data-url="http://scofield1920.github.io/nssctf-web-wp/" data-title="NSSCTF-web-wp" data-hashtags="web"><span class="fab fa-twitter fa-fw"></span></button><button title="Share on Facebook" data-sharer="facebook" data-url="http://scofield1920.github.io/nssctf-web-wp/" data-hashtag="web"><span class="fab fa-facebook-square fa-fw"></span></button><button title="Share on Hacker News" data-sharer="hackernews" data-url="http://scofield1920.github.io/nssctf-web-wp/" data-title="NSSCTF-web-wp"><span class="fab fa-hacker-news fa-fw"></span></button><button title="Share on Line" data-sharer="line" data-url="http://scofield1920.github.io/nssctf-web-wp/" data-title="NSSCTF-web-wp"><span data-svg-src="/lib/simple-icons/icons/line.min.svg"></span></button><button title="Share on å¾®åš" data-sharer="weibo" data-url="http://scofield1920.github.io/nssctf-web-wp/" data-title="NSSCTF-web-wp"><span class="fab fa-weibo fa-fw"></span></button><button title="Share on Telegram" data-sharer="telegram" data-url="http://scofield1920.github.io/nssctf-web-wp/" data-title="NSSCTF-web-wp" data-web><span class="fab fa-telegram-plane fa-fw"></span></button><script>
        function shareOnMastodon(title, link) {
            const SHARE_MASTODON_DOMAIN = "share_mastodon_domain"
            const savedDomain = localStorage.getItem(SHARE_MASTODON_DOMAIN) ?? "mastodon.social";
            const domain = prompt("Enter your Mastodon domain", savedDomain);
            if (domain === null) {
                return;
            }
            localStorage.setItem(SHARE_MASTODON_DOMAIN, domain)
            const text = title + "\n\n" + link;
            const url = new URL("https://" + domain)
            url.pathname = "share"
            url.searchParams.append('text', text)
            window.open(url, '_blank', "width=500,height=500,left=500,toolbar=0,status=0");
        }
    </script>
    <button title="Share on Mastodon"onclick="javascript:shareOnMastodon(&#34;NSSCTF-web-wp&#34;, &#34;http://scofield1920.github.io/nssctf-web-wp/&#34;)"><span class="fab fa-mastodon fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/web/">Web</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/php/" class="prev" rel="prev" title="PHP"><i class="fas fa-angle-left fa-fw"></i>PHP</a>
            <a href="/nssctf-reverse-wp/" class="next" rel="next" title="NSSCTF-reverse-wp">NSSCTF-reverse-wp<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.124.1">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div>
    
        
        <script async src=" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js "></script>
    

    
        
            <section>
                
                    <span id="busuanzi_container_value_site_pv"><i class="far fa-eye fa-fw"></i>
                        
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                

                
                    &nbsp;|&nbsp;              
                

                
                    <span id="busuanzi_container_value_site_uv"><i class="fa fa-user"></i>
                        
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
            </section>
        

        
        
    

</footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"Hugo-DoIt/utterances-comments"}},"data":{"desktop-header-typeit":"Sc0fie1d-Blog","mobile-header-typeit":"Sc0fie1d-Blog"},"search":{"algoliaAppID":"5YGRNRQK1G","algoliaIndex":"en_index","algoliaSearchKey":"0ff6874805de24b84aa1d5ebccad56cd","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":300,"type":"algolia"},"sharerjs":true,"table":{"sort":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/js/theme.min.js" defer></script><script type="text/javascript" src="/js/utterances.min.js" defer></script></div>
</body>

</html>